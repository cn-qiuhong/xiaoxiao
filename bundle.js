!function e(t,i,s){function n(r,o){if(!i[r]){if(!t[r]){var h="function"==typeof require&&require;if(!o&&h)return h(r,!0);if(a)return a(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[r]={exports:{}};t[r][0].call(l.exports,function(e){var i=t[r][1][e];return n(i?i:e)},l,l.exports,e,t,i,s)}return i[r].exports}for(var a="function"==typeof require&&require,r=0;r<s.length;r++)n(s[r]);return n}({1:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t,i,s){var n=Math.abs(e-i),a=Math.abs(t-s);return n+a===1}function a(){return Math.floor(Math.random()*this.numBlockTypes)}function r(e){return e instanceof Array&&e.length?e[e.length-1]:null}var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.isAdjacent=n;var h=function(){function e(t,i){s(this,e),this.ops=t,this.numBlockTypes=t.numBlockTypes||5,this.baseScore=t.baseScore||300,this.cols=t.cols||8,this.rows=t.rows||8,this.stepslimit=t.stepslimit,this.stepsorigin=this.stepslimit,this.time=t.time,this.remainingtime=t.time,this.usetime=0,this.level=t.level,this.score=0,this.sk_warrior=1,this.sk_priest=1,this.sk_rune_keeper=1,this.sk_robber=1,this.sk_hunter=1,this.sk_player=!0,this.energy=t.hero.energy,this.eliminatedata=[];for(var n=0;8>n;n++)this.eliminatedata[n]=0;this.blocks=null,this.gameing=!0,this.gameover=!1,this.initBoardData(t),this.initSurface(t),this.initMission(t.mission),this._fillBoard(t.blocks,t.hero),i&&i()}return o(e,[{key:"_canBlockMove",value:function(e,t,i){return e>0&&this.canSwap(e,t,e-1,t,i)?{x:e-1,y:t}:e<this.cols-1&&this.canSwap(e,t,e+1,t,i)?{x:e+1,y:t}:t>0&&this.canSwap(e,t,e,t-1,i)?{x:e,y:t-1}:t<this.rows-1&&this.canSwap(e,t,e,t+1,i)?{x:e,y:t+1}:!1}},{key:"_check",value:function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],i=arguments.length<=2||void 0===arguments[2]?null:arguments[2],s=this._getChains(),n=!1,a=void 0,r=void 0,o=[],h=[],c=[],l=[],u=[],g=[],f={event:e,removed:o,changed:c,bossdamage:g,score:u,p1:t,p2:i};if(this.chaincopy=s,this.scorechain=s,this.blocksCopy(),this.goldbeanget>1&&this.goldbeanget--,this.zhulouluotime>0&&this.zhulouluotime--,t&&(a=this.getBlock(t.x,t.y),r=this.getBlock(i.x,i.y)),5==a||5==r){if(n=!0,5==a?(this.setBlock(t.x,t.y,-2),o.push({x:t.x,y:t.y,type:a}),this.changeBoardData(t.x,t.y,c),r=this.getColor(i.x,i.y)):5==r&&(this.setBlock(i.x,i.y,-2),o.push({x:i.x,y:i.y,type:r}),this.changeBoardData(i.x,i.y,c),r=this.getColor(t.x,t.y)),5==r)this.setBlock(i.x,i.y,-2),o.push({x:i.x,y:i.y,type:r}),g.push(10),this.changeBoardData(i.x,i.y,c);else if(6==r)return;for(var p=0;p<this.cols;p++)for(var d=0;d<this.rows;d++)(r<this.numBlockTypes&&this.getBlock(p,d)==r||5==r)&&this.triggerEffectSquare(p,d,f)}else for(var p=0;p<this.cols;p++)for(var d=this.rows-1;d>=0;d--)s[p][d]>2&&(n=!0,this.triggerEffectSquare(p,d,f));for(var m=0;m<u.length;m++)this.score+=u[m].score;return this.moveGapSquareAll(h,l),this.createNewSquare(h,l),this.zhulouluoDibuPanding(),n?(e.push({type:"remove",data:o},{type:"change",data:c},{type:"bossdamage",data:g},{type:"score",data:u},{type:"move",data:h},{type:"goldbeanremove",data:l}),this.gameover&&e.push({type:"gameover"}),this._hasMoves()||(this._fillBoard(),e.push({type:"refill",data:this.getBoard()})),this._check(e)):(e.push({type:"over"}),this.hasClearMission(e),this.gameover&&e.push({type:"gameover"}),e)}},{key:"_checkChain",value:function(e,t){var i=this.getColor(e,t),s=0,n=0,a=0,r=0;if(0>i)return 0;for(i>6&&(i=this.getColor(i));i===this.getColor(e+n+1,t);)n++;for(;i===this.getColor(e-s-1,t);)s++;for(;i===this.getColor(e,t+a+1);)a++;for(;i===this.getColor(e,t-r-1);)r++;return Math.max(s+1+n,r+1+a)}},{key:"_checkChainDetailed",value:function(e,t){var i=this.getCopyBlock(e,t),s=0,n=0,a=0,r=0;if(0>i)return 0;for(i>6&&(i=this.getColor(i));i===this.getColor(e+n+1,t);)n++;for(;i===this.getColor(e-s-1,t);)s++;for(;i===this.getColor(e,t+a+1);)a++;for(;i===this.getColor(e,t-r-1);)r++;var o=s+1+n,h=r+1+a;return{row:o,col:h}}},{key:"_checkCopyChain",value:function(e,t){return 0>e||e>this.cols-1||0>t||t>this.rows-1?-1:this.chaincopy[e][t]}},{key:"_fillBoard",value:function(e,t){var i=void 0;this.blocks=[];var s=void 0;if(this.mission&&"cellect"==this.mission.type)do s=parseInt(Math.random()*this.cols);while(this.getBoardData(s,0)<=0||this.getSurface(s,0)>1||e&&e[0][s]>9);var n=void 0;if(t){this.hero=t;do n=parseInt(Math.random()*this.cols);while(this.getBoardData(n,0)<=0||5==this.getBoardData(n,0)||this.getSurface(n,0)>1||n==s||this.inBossSite(n,0))}var r=void 0;if(this.zhulouluo){if(Math.random()<.2)do r=parseInt(Math.random()*this.cols);while(this.getBoardData(r,0)<=0||5==this.getBoardData(r,0)||this.getSurface(r,0)>1||r==s||this.inBossSite(r,0)||r==n);this.zhulouluotime=parseInt(4*Math.random()+2)}for(var o=0;o<this.cols;o++){this.blocks[o]=[];for(var h=0;h<this.rows;h++){var c=this.getBoardData(o,h),l=this.getSurface(o,h);if(5!=c)if(0>=c||this.inBossSite(o,h)||2==l||5==l)this.setBlock(o,h,-1),this.inBossSite(o,h)&&this.setBoardData(o,h,0);else if(e)this.setBlock(o,h,e[h][o]);else if(o!=s||0!=h)if(o!=n||0!=h)if(o!=r||0!=h){do i=a.call(this);while(i===this.getColor(o-1,h)&&i===this.getColor(o-2,h)||i===this.getColor(o,h-1)&&i===this.getColor(o,h-2));this.setBlock(o,h,i)}else this.setBlock(o,h,13);else this.setBlock(o,h,t.id);else this.setBlock(o,h,6);else this.setBlock(o,h,-2),this.inBossSite(o,h)&&(this.setBoardData(o,h,0),this.setBlock(o,h,-1))}}this._hasMoves()||this._fillBoard()}},{key:"_getChains",value:function(){for(var e=[],t=0;t<this.cols;t++){e[t]=[];for(var i=0;i<this.rows;i++)e[t][i]=this._checkChain(t,i)}return e}},{key:"_hasMoves",value:function(e){for(var t=0;t<this.cols;t++)for(var i=0;i<this.rows;i++){var s=this._canBlockMove(t,i,e);if(s)return{x:t,y:i,p2:s}}return!1}},{key:"blocksCopy",value:function(){this.blockscopy=[];for(var e=0;e<this.cols;e++)this.blockscopy[e]=this.blocks[e].concat()}},{key:"boarddataCopy",value:function(){this.bdcopy=[];for(var e=0;e<this.rows;e++)this.bdcopy[e]=this.boarddata[e].concat()}},{key:"bossSkillLaunch",value:function(e,t){if(this.bossjishi+=e,1==this.bosstype&&this.bossjishi>=1e4){this.bossjishi-=1e4;for(var i=0,s=[],n=[],a=0;15>a;a++){var r=parseInt(Math.random()*this.cols),o=parseInt(Math.random()*this.rows);if(this.getBlock(r,o)>=0&&this.getBlock(r,o)<5&&1==this.getSurface(r,o)){if(this.setSurface(r,o,3),this.nikuaitime[r][o]=0,n.push({x:r,y:o,data:3,type:"sf"}),i>0)break;i++}}n.length>0&&(s.push({type:"change",data:n}),t.boardEventsHandler(s))}}},{key:"canSwap",value:function(e,t,i,s,a){if(!n(e,t,i,s))return!1;var r=this.getBlock(e,t),o=this.getBlock(i,s),h=void 0,c=this.getBoardData(e,t),l=this.getBoardData(i,s),u=this.getSurface(e,t),g=this.getSurface(i,s);if(-1==r||-1==o||r==o||5==c||5==l||u>1||g>1)return!1;if(this._checkChain(i,s)>2||this._checkChain(e,t)>2)return!1;this.setBlock(e,t,o),this.setBlock(i,s,r);var f=this._checkChain(e,t),p=this._checkChain(i,s);if(a)switch(this.chaincopy=this._getChains(),this.scorechain=this._getChains(),this.blocksCopy(),a){case 3:case 4:h=f>a||p>a||this.createESBLJ(e,t,3)||this.createESBLJ(i,s,3)?!1:f==a||p==a;break;case 5:h=f==a||p==a||this.createESBLJ(e,t,3)||this.createESBLJ(i,s,3)}else h=f>2||p>2;return this.setBlock(e,t,r),this.setBlock(i,s,o),h}},{key:"changeBoardData",value:function(e,t){var i=arguments.length<=2||void 0===arguments[2]?[]:arguments[2],s=this.getBoardData(e,t);switch(s){case 2:case 3:s--,this.setBoardData(e,t,s),1==s&&this.eliminatedata[5]++,i.push({x:e,y:t,data:s,edata:5,type:"bd"})}var n=this.getSurface(e,t);switch(n){case 2:this.setSurface(e,t,1),this.setBlock(e,t,-2),i.push({x:e,y:t,data:1,type:"sf"});break;case 3:this.setSurface(e,t,1),this.eliminatedata[6]++,this.nikuaitime[e][t]=0,i.push({x:e,y:t,data:1,edata:6,type:"sf"});break;case 4:this.setSurface(e,t,1),i.push({x:e,y:t,data:1,type:"sf"})}this.changeSurface(e,t-1,i),this.changeSurface(e,t+1,i),this.changeSurface(e-1,t,i),this.changeSurface(e+1,t,i)}},{key:"changeSurface",value:function(e,t){var i=arguments.length<=2||void 0===arguments[2]?[]:arguments[2],s=this.getSurface(e,t);switch(s){case 2:this.setSurface(e,t,1),this.setBlock(e,t,-2),i.push({x:e,y:t,data:1,type:"sf"});break;case 3:this.setSurface(e,t,1),this.eliminatedata[6]++,this.nikuaitime[e][t]=0,i.push({x:e,y:t,data:1,edata:6,type:"sf"});break;case 4:this.setSurface(e,t,1),i.push({x:e,y:t,data:1,type:"sf"})}}},{key:"checkGoldenBean",value:function(e,t,i,s,n){6==this.getBlock(e,t)&&(i.length?(e=i[i.length-1],t=s[s.length-1]+1):t++,t==this.rows&&(i.push(e),s.push(t),n.push({x:e,y:t,type:6}),this.goldbeans++,this.goldbeanget=parseInt(4*Math.random()+1)))}},{key:"clearOtherSquare",value:function(e,t){var i=this._checkChainDetailed(e,t),s=i.row,n=i.col;if(s>3)for(var a=1;s>a;a++)this.chaincopy[e+a][t]=3;else if(n>3)for(var a=1;n>a;a++)this.chaincopy[e][t-a]=3}},{key:"clodInfect",value:function(e){if(!(this.nikuaijishi<1e4||this.nikuaimanyaning||this.swaping||this.skilltriggering)){this.nikuaimanyaning=!0,this.surfaceCopy();var t=[-1,0,1,1,1,0,-1,-1],i=[-1,-1,-1,0,1,1,1,0],s=void 0,n=void 0,a=void 0,r=void 0,o=[],h=[];for(s=0;s<this.cols;s++)for(n=0;n<this.rows;n++){var c=0,l={num:2};for(a=s+t[c],r=n+i[c];3==this.getSfCopy(s,n)&&this.clodCouldInfect(a,r,l,h)&&!(c>6);)c++,a=s+t[c],r=n+i[c]}h.length?o.push({type:"change",data:h}):(this.gameOver(),o.push({type:"gameover"})),e.selectable=!1,e.boardEventsHandler(o),this.nikuaijishi=this.nikuaimanyaning=0}}},{key:"clodInfec",value:function(e,t){if(!(this.nikuaimanyaning||this.swaping||this.skilltriggering)){this.nikuaimanyaning=!0,this.surfaceCopy();var i=[-1,0,1,1,1,0,-1,-1],s=[-1,-1,-1,0,1,1,1,0],n=void 0,a=void 0,r=void 0,o=void 0,h=[],c=[],l=void 0;for(n=0;n<this.cols;n++)for(a=0;a<this.rows;a++)if(3==this.getSfCopy(n,a)&&(this.nikuaitime[n][a]+=e,!(this.nikuaitime[n][a]<5e3||isNaN(this.nikuaitime[n][a])))){l=!0;var u=0,g={num:2};for(r=n+i[u],o=a+s[u];this.clodCouldInfect(r,o,g,c)&&!(u>6);)u++,r=n+i[u],o=a+s[u];this.nikuaitime[n][a]=0}if(l){if(c.length)h.push({type:"change",data:c});else{var f=!1;for(n=0;n<this.cols;n++){for(a=0;a<this.rows;a++){var p=this.getBlock(n,a),d=this.getSurface(n,a);if(p>=0&&5>p&&1==d){f=!0;break}}if(f)break}f||(this.gameOver(),h.push({type:"gameover"}))}h.length&&(t.selectable=!1,t.boardEventsHandler(h))}this.nikuaimanyaning=!1}}},{key:"clodCouldInfect",value:function(e,t,i,s){var n=(this.getBoardData(e,t),this.getSurface(e,t)),a=this.getBlock(e,t);return 0>a||a>4||n>1?!0:(this.setSurface(e,t,3),this.nikuaitime[e][t]=0,"eliminate"==this.mission.type&&6==this.mission.data[0].type&&this.mission.data[0].data++,s.push({x:e,y:t,data:3,type:"sf"}),--i.num)}},{key:"createEffectSquare",value:function(e,t,i){var s=this.getBlock(e,t),n=!1,a=this.chaincopy[e][t];if(5==a){var r=i.p1,o=i.p2;r&&this.getBlock(r.x,r.y)<10&&this.getBlock(o.x,o.y)<10?(e==r.x&&t==r.y||e==o.x&&t==o.y)&&(this.setBlock(e,t,5),i.changed.push({x:e,y:t,data:5,type:"bl"}),n=!0):(this.setBlock(e,t,5),i.changed.push({x:e,y:t,data:5,type:"bl"}),n=!0,this.clearOtherSquare(e,t))}else if(4==a||3==a&&this.createESBLJ(e,t)){switch(s){case 0:this.sk_warrior<9&&this.sk_warrior++;break;case 1:this.sk_priest<9&&this.sk_priest++;break;case 2:this.sk_rune_keeper<9&&this.sk_rune_keeper++;break;case 3:this.sk_robber<9&&this.sk_robber++;break;case 4:this.sk_hunter<9&&this.sk_hunter++}this.clearOtherSquare(e,t),i.event.push({type:"updateskillnum"})}if(!n){13==s&&(s=7),this.eliminatedata[s]++,i.removed.push({x:e,y:t,type:s}),this.getColor(this.hero.id)==s&&this.energy<this.hero.energy&&++this.energy==this.hero.energy&&(this.sk_player=!0,console.log("sk_player true")),this.setBlock(e,t,-2);var h=this.scorechain[e][t];a>2?i.score.push({score:this.baseScore*Math.pow(2,h-3),x:e,y:t,type:s}):i.score.push({score:this.baseScore,x:e,y:t,type:s})}this.inBossSide(e,t)&&(i.bossdamage.push(1),this.boss.hp-=1)}},{key:"createESBLJ",value:function(e,t,i){if(0>e||0>t||e>=this.cols||t>this.rows)return!1;var s=this.getCopyBlock(e,t),n=void 0,a=void 0,r=void 0,o=void 0,h=void 0,c=void 0;n=a=r=o=h=c=!1,s==this.getCopyBlock(e-1,t)&&this._checkCopyChain(e-1,t)>2&&s==this.getCopyBlock(e-2,t)&&this._checkCopyChain(e-2,t)>2&&(n=!0),s==this.getCopyBlock(e,t-1)&&this._checkCopyChain(e,t-1)>2&&s==this.getCopyBlock(e,t-2)&&this._checkCopyChain(e,t-2)>2&&(r=!0),s==this.getCopyBlock(e+1,t)&&this._checkCopyChain(e+1,t)>2&&s==this.getCopyBlock(e+2,t)&&this._checkCopyChain(e+2,t)>2&&(a=!0),s==this.getCopyBlock(e,t+1)&&this._checkCopyChain(e,t+1)>2&&s==this.getCopyBlock(e,t+2)&&this._checkCopyChain(e,t+2)>2&&(o=!0),s==this.getCopyBlock(e-1,t)&&this._checkCopyChain(e-1,t)>2&&s==this.getCopyBlock(e+1,t)&&this._checkCopyChain(e+1,t)>2&&(c=!0),s==this.getCopyBlock(e,t-1)&&this._checkCopyChain(e,t-1)>2&&s==this.getCopyBlock(e,t+1)&&this._checkCopyChain(e,t+1)>2&&(h=!0);var l=(n||a||c)&&(r||o||h);return!l&&--i>0?this.createESBLJ(e-1,t,i)||this.createESBLJ(e+1,t,i)||this.createESBLJ(e,t-1,i)||this.createESBLJ(e,t+1,i):l}},{key:"createNewSquare",value:function(e,t){for(var i=0;i<this.cols;i++)for(var s=-1;this.getBlock(i,0)<-1&&!this.isBarrier(i,0);){1==this.goldbeanget?(this.goldbeanget=0,this.setBlock(i,0,6)):0==this.zhulouluotime?(this.zhulouluotime=parseInt(4*Math.random()+2),this.setBlock(i,0,13)):this.setBlock(i,0,a.call(this));var n=[i],o=[0],h=this.getBlock(i,0);this.fillBlank(i,0,n,o);var c=r(n),l=r(o);if(5==this.getBoardData(c,l)){this.setBlock(i,0,-2);break}this.checkGoldenBean(i,0,n,o,t),this.pathOptimizeMove(i,n,o),e.push({toX:n,toY:o,fromX:i,fromY:s,type:h}),(c!=i||0!=l||l==this.rows)&&(this.setBlock(i,0,-2),l<this.rows&&this.setBlock(c,l,h)),s--}}},{key:"fillBlank",value:function(e,t,i,s){t+1>=this.rows||(this.getBlock(e,t+1)<-1&&!this.isBarrier(e,t+1)?(i.push(e),s.push(t+1),this.fillBlank(e,t+1,i,s)):!this.hasBarrier(e-1,t+1)||this.isBarrier(e,t+1)&&this.isBarrier(e-1,t)?!this.hasBarrier(e+1,t+1)||this.isBarrier(e,t+1)&&this.isBarrier(e+1,t)||(i.push(e+1),s.push(t+1),this.fillBlank(e+1,t+1,i,s)):(i.push(e-1),s.push(t+1),this.fillBlank(e-1,t+1,i,s)))}},{key:"gameOver",value:function(){this.gameover=!0,this.gameing=!1}},{key:"gameOverJudge",value:function(e,t){if(this.gameing){if(this.usetime+=e,this.remainingtime=1e3*this.time-this.usetime,this.time&&this.remainingtime<0)return this.gameOver(),!0;this.nikuaijishi&&this.clodInfec(e,t),this.bossSkillLaunch(e,t)}}},{key:"getBlock",value:function(e,t){return 0>e||e>this.cols-1||0>t||t>this.rows-1?-1:this.blocks[e][t]}},{key:"getColor",value:function(e,t){var i=void 0;switch(i=null==t?e:this.getBlock(e,t)){case 7:return 0;case 8:return 1;case 9:case 12:return 2;case 10:return 3;case 11:return 4}return i}},{key:"getCopyBlock",value:function(e,t){return 0>e||e>this.cols-1||0>t||t>this.rows-1?-1:this.blockscopy[e][t]}},{key:"getBoard",value:function(){for(var e=[],t=0;t<this.cols;t++)e[t]=this.blocks[t].slice(0);return e}},{key:"getBoardData",value:function(e,t){return 0>e||e>this.cols-1||0>t||t>this.rows-1?-1:this.boarddata[t][e]}},{key:"getBdCopy",value:function(e,t){return 0>e||e>this.cols-1||0>t||t>this.rows-1?-1:this.bdcopy[t][e]}},{key:"getSurface",value:function(e,t){return 0>e||e>this.cols-1||0>t||t>this.rows-1?-1:this.surface[t][e]}},{key:"getSfCopy",value:function(e,t){return 0>e||e>this.cols-1||0>t||t>this.rows-1?-1:this.sfcopy[t][e]}},{key:"hasBarrier",value:function(e,t){if(!(this.getBlock(e,t)>-2||this.isBarrier(e,t)||1>t||t>=this.rows))for(var i=t-1;i>=0;i--){if(this.getBlock(e,i)>=0)return this.isBarrier(e,i);if(this.isBarrier(e,i))return!0}}},{key:"hasClearMission",value:function(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0],t=arguments[1],i=this.mission;if(i){var s=i.data;switch(i.type){case"score":this.score>=s&&(t=!0);break;case"eliminate":for(var n=0;n<s.length;n++){var a=s[n].type;if(this.eliminatedata[a]<s[n].data)break;n==s.length-1&&(t=!0)}break;case"cellect":this.goldbeans>=s&&(t=!0);break;case"boss":this.boss.hp<1&&(t=!0);break;case"rescue":for(var n=0;n<s.length;n++){var r=s[n];if(this.isBegirt(r.x,r.y))break;this.rescuecunminshu=n+1,n+1==s.length&&(t=!0)}}if(t){this.gameclear=!0,this.gameing=!1;var o=void 0;this.stepsorigin?o=this.stepslimit/this.stepsorigin:this.time&&(o=(this.time-this.usetime/1e3)/this.time),console.log("得分比例:"+o),o>.5?this.star=3:o>.25?this.star=2:this.star=1,console.log("过关星级："+this.star),this.gameOver(),e.push({type:"clear"})}}}},{key:"inBossSite",value:function(e,t){return this.boss?e>=this.boss.x&&e<=this.boss.x2&&t>=this.boss.y&&t<=this.boss.y2:!1}},{key:"inBossSide",value:function(e,t){return this.boss?e>=this.boss.x-1&&e<=this.boss.x2+1&&t>=this.boss.y-1&&t<=this.boss.y2+1:void 0}},{key:"initBoardData",value:function(e){if(e.boarddata)this.boarddata=e.boarddata;else{this.boarddata=[];for(var t=0;t<this.rows;t++){this.boarddata[t]=[];for(var i=0;i<this.cols;i++)this.boarddata[t][i]=1}}}},{key:"initMission",value:function(e){if(e){this.mission=e,this.setBoss(e),this.goldbeans=0,this.goldbeanget=0,this.rescuecunminshu=0;var t=e.data;if("escape"==e.type)this.setBoardData(t.x,t.y,4);else if("eliminate"==e.type)for(var i=0;i<t.length;i++){var s=t[i].type;if(6==s){this.nikuaijishi=!0,this.nikuaitime=[];for(var n=0;n<this.cols;n++){this.nikuaitime[n]=[];for(var a=0;a<this.rows;a++)this.nikuaitime[n][a]=0}}else 7==s&&(this.zhulouluo=!0)}}}},{key:"initSurface",value:function(e){if(e.surface)this.surface=e.surface;else{this.surface=[];for(var t=0;t<this.rows;t++){this.surface[t]=[];for(var i=0;i<this.cols;i++)this.surface[t][i]=1}}}},{key:"isBarrier",value:function(e,t){var i=this.getBoardData(e,t),s=this.getSurface(e,t),n=this.getBlock(e,t+1);return 1>i||s>1||5==i&&-2!=n}},{key:"isEliminatable",value:function(e,t){var i=this.getBlock(e,t);return i>-1&&i<this.numBlockTypes||this.getSurface(e,t)>1||13==i}},{key:"isHero",value:function(e){return e>6&&13>e?1:void 0}},{key:"isBegirt",value:function(e,t){return 4==this.getSurface(e-1,t)?!0:4==this.getSurface(e-1,t-1)?!0:4==this.getSurface(e,t-1)?!0:4==this.getSurface(e+1,t-1)?!0:4==this.getSurface(e+1,t)?!0:4==this.getSurface(e+1,t+1)?!0:4==this.getSurface(e,t+1)?!0:4==this.getSurface(e-1,t+1)?!0:void 0}},{key:"moveGapSquare",value:function(e,t,i,s){var n=arguments.length<=4||void 0===arguments[4]?[]:arguments[4],a=arguments.length<=5||void 0===arguments[5]?[]:arguments[5],o=this.getBoardData(e,t),h=this.getBlock(e,t),c=this.getSurface(e,t);if(!(0>h||1>o||c>1)&&(this.fillBlank(e,t,n,a),this.checkGoldenBean(e,t,n,a,s),n.length)){this.pathOptimizeMove(e,n,a),i.push({toX:n,toY:a,fromX:e,fromY:t,type:h});var l=r(n),u=r(a);u<this.rows&&this.setBlock(l,u,h),this.setBlock(e,t,-2)}}},{key:"moveGapSquareAll",value:function(e,t){for(var i=this.rows-1;i>=0;i--)for(var s=0;s<this.cols;s++)this.moveGapSquare(s,i,e,t)}},{key:"pathOptimizeMove",value:function(e,t,i){if(t instanceof Array&&!(t.length<2)){var s=void 0;s=e==t[0]?"|":e>t[0]?"/":"\\",e=t[0];for(var n=1;n<t.length;)t[n]==e?"|"==s?(t.splice(n-1,1),i.splice(n-1,1)):s="|":t[n]<e?"/"==s?(t.splice(n-1,1),i.splice(n-1,1)):s="/":"\\"==s?(t.splice(n-1,1),i.splice(n-1,1)):s="\\",e=t[n]}}},{key:"print",value:function(){for(var e="",t=0;t<this.rows;t++){for(var i=0;i<this.cols;i++)e+=this.getBlock(i,t)>=0&&this.getBlock(i,t)<10?"·"+this.getBlock(i,t)+" ":this.getBlock(i,t)+" ";e+="\n"}console.log(e)}},{key:"setBlock",value:function(e,t,i){if(0>e||e>this.cols-1||0>t||t>this.rows-1)throw new Error("out of range of blocks;x:"+e+",y:"+t);this.blocks[e][t]=i}},{key:"setBoardData",value:function(e,t,i){if(0>e||e>this.cols-1||0>t||t>this.rows-1)throw new Error("out of range of blocks");this.boarddata[t][e]=i}},{key:"setBoss",value:function(e){if("boss"==e.type&&(this.boss=e.data,this.bosstype=this.boss.type,this.bossjishi=0,this.boss.w=this.boss.x2-this.boss.x,this.boss.h=this.boss.y2-this.boss.y,1==this.bosstype)){this.nikuaijishi=!0,this.nikuaitime=[];for(var t=0;t<this.cols;t++)this.nikuaitime[t]=[]}}},{key:"setSurface",value:function(e,t,i){if(0>e||e>this.cols-1||0>t||t>this.rows-1)throw new Error("out of range of blocks");this.surface[t][e]=i}},{key:"skillTrigger",value:function(e,t,i){this.skilltriggering=!0;var s=[],n=[],a=[],r=[],o=[],h=[],c=[],l={event:s,removed:r,changed:n,bossdamage:c,score:a};switch(this.chaincopy=this._getChains(),this.scorechain=this._getChains(),e){case 1:this.skillWarrior(t,l);break;case 3:this.skillRuneKeeper(t,l);break;case 4:this.skillRobber(t,l);break;case 5:this.skillHunter(t,l);break;case 7:t.view.skilllaunchnum++,this.skillMobaoshi(t,s);break;case 9:this.skillModaoshi(t,l);break;case 10:this.skillRobber(t,l,1);break;case 11:this.skillNupaoshou(t,l);break;case 12:this.skillFuwenYinjieShaonv(t,l)}for(var u=0;u<a.length;u++)this.score+=a[u].score;this.moveGapSquareAll(o,h),this.createNewSquare(o,h),s.push({type:"updateskillnum"},{type:"remove",data:r},{type:"change",data:n},{type:"bossdamage",data:c},{type:"score",data:a},{type:"move",data:o},{type:"goldbeanremove",data:h}),this._check(s),this.skilltriggering=!1,i(s)}},{key:"skillWarrior",value:function(e,t){this.sk_warrior--;var i=e.x,s=e.y;this.triggerEffectSquare(i-1,s-1,t),this.triggerEffectSquare(i-1,s,t),this.triggerEffectSquare(i-1,s+1,t),this.triggerEffectSquare(i,s+1,t),this.triggerEffectSquare(i,s,t),this.triggerEffectSquare(i,s-1,t),this.triggerEffectSquare(i+1,s-1,t),this.triggerEffectSquare(i+1,s,t),this.triggerEffectSquare(i+1,s+1,t),this.skillWarriorDamageBoss(i,s)&&(this.boss.hp-=5,t.bossdamage.push(5))}},{key:"skillWarriorDamageBoss",value:function(e,t){return this.inBossSite(e-1,t-1)||this.inBossSite(e-1,t)||this.inBossSite(e-1,t+1)||this.inBossSite(e,t-1)||this.inBossSite(e,t)||this.inBossSite(e,t+1)||this.inBossSite(e+1,t-1)||this.inBossSite(e+1,t)||this.inBossSite(e+1,t+1)}},{key:"skillPriest",value:function(){if(this.sk_priest--,this.stepslimit<98)this.stepslimit+=2;else if(this.stepslimit<99)this.stepslimit++,this.time+=5;else if(this.time)this.time+=10;else if(this.sk_hunter<99||this.sk_robber<99||this.sk_rune_keeper<99||this.sk_warrior<99){var e=!1;do switch(parseInt(4*Math.random())){case 0:this.sk_warrior<99&&(this.sk_warrior++,e=!0);break;case 1:this.sk_rune_keeper<99&&(this.sk_rune_keeper++,e=!0);break;case 2:this.sk_robber<99&&(this.sk_robber++,e=!0);break;case 3:this.sk_hunter<99&&(this.sk_hunter++,e=!0)}while(!e)}}},{key:"skillRuneKeeper",value:function(e,t){var i=e.p.x,s=e.p.y,a=e.p2.x,r=e.p2.y,o=this.getBlock(i,s),h=this.getBlock(a,r);(!this.isHero(o)&&!this.isHero(h)||n(i,s,a,r))&&(this.sk_rune_keeper--,this.setBlock(i,s,h),this.setBlock(a,r,o),t.event.push({type:"swap",data:{x1:i,y1:s,x2:a,y2:r}}))}},{key:"skillRobber",value:function(e,t,i){i||this.sk_robber--;var s=e.x,n=e.y,a=this.getBlock(s,n);0>a||(a<this.numBlockTypes?this.eliminatedata[a]++:6==a?(this.goldbeans++,this.goldbeanget=parseInt(4*Math.random()+1)):13==a&&this.eliminatedata[7]++,t.removed.push({x:s,y:n,type:a}),this.setBlock(s,n,-2),i&&this.changeBoardData(s,n,t.changed))}},{key:"skillHunter",value:function(e,t){var i=e.p.x,s=e.p.y,n=e.p2.x,a=e.p2.y;if(i==n||s==a)if(this.sk_hunter--,i==n){for(var r=0;r<this.rows;r++)this.triggerEffectSquare(i,r,t);this.boss&&i>=this.boss.x&&i<=this.boss.x2&&(this.boss.hp-=5,t.bossdamage.push(5))}else{for(var r=0;r<this.rows;r++)this.triggerEffectSquare(r,s,t);this.boss&&s>=this.boss.y&&s<=this.boss.y2&&(this.boss.hp-=5,t.bossdamage.push(5))}}},{key:"skillMobaoshi",value:function(e,t){var i=e.x,s=e.y,n=e.view,a=[],r=[],o=[],h=[],c=[],l=[],u={event:t,removed:o,changed:a,bossdamage:l,score:r};this.triggerEffectSquare(i-1,s-1,u),this.triggerEffectSquare(i-1,s,u),this.triggerEffectSquare(i-1,s+1,u),this.triggerEffectSquare(i,s+1,u),this.triggerEffectSquare(i,s,u),this.triggerEffectSquare(i,s-1,u),this.triggerEffectSquare(i+1,s-1,u),this.triggerEffectSquare(i+1,s,u),this.triggerEffectSquare(i+1,s+1,u),this.skillWarriorDamageBoss(i,s)&&(this.boss.hp-=5,l.push(5));for(var g=0;g<r.length;g++)this.score+=r[g].score;this.moveGapSquareAll(h,c),this.createNewSquare(h,c),t.push({type:"updateskillnum",data:--n.skilllaunchnum},{type:"remove",data:o},{type:"change",data:a},{type:"bossdamage",data:l},{type:"score",data:r},{type:"move",data:h},{type:"goldbeanremove",data:c}),n.skilllaunchnum&&this.skillMobaoshi(e,t)}},{key:"skillModaoshi",value:function(e,t){for(var i=void 0,s=void 0,n=void 0,a=0;a<e.length;a++)if(i=e[a],s=i.x,s>=0)for(var r=0;r<this.rows;r++)this.triggerEffectSquare(s,r,t);else if(n=i.y,n>=0)for(var r=0;r<this.cols;r++)this.triggerEffectSquare(r,n,t)}},{key:"skillNupaoshou",value:function(e,t){for(var i=0;i<e.length&&3>i;i++){var s=e[i].x,n=e[i].y;this.isEliminatable(s,n)&&(this.changeBoardData(s,n,t.changed),this.createEffectSquare(s,n,t))}}},{key:"skillFuwenYinjieShaonv",value:function(e,t){if("oo"==e.skilllaunchnum){for(;this._hasMoves(3);){var i=this._hasMoves(3),s=i.x,n=i.y,a=i.p2,r=a.x,o=a.y,h=this.getBlock(s,n),c=this.getBlock(r,o);this.setBlock(s,n,c),this.setBlock(r,o,h),t.event.push({type:"swap",data:{x1:s,y1:n,x2:r,y2:o}}),t.event.push({type:"updateskillnum",data:"oo"})}e.skilllaunchnum=0}else for(var l=0;l<e.skilllaunchnum;){var i=this._hasMoves(3);if(!i)return e.skilllaunchnum=0;var s=i.x,n=i.y,a=i.p2,r=a.x,o=a.y,h=this.getBlock(s,n),c=this.getBlock(r,o);this.setBlock(s,n,c),this.setBlock(r,o,h),t.event.push({type:"swap",data:{x1:s,y1:n,x2:r,y2:o}}),t.event.push({type:"updateskillnum",data:--e.skilllaunchnum})}}},{key:"surfaceCopy",value:function(){this.sfcopy=[];for(var e=0;e<this.rows;e++)this.sfcopy[e]=this.surface[e].concat()}},{key:"swap",value:function(e,t,i,s,n){this.swaping=!0;var a=void 0,r=[],o=this.getSurface(e,t),h=this.getSurface(i,s);if(o>1||h>1)return this.swaping=!1,n(r);a=this.getBlock(e,t),this.setBlock(e,t,this.getBlock(i,s)),this.setBlock(i,s,a),r.push({type:"swap",data:{x1:e,y1:t,x2:i,y2:s}}),this._check(r,{x:e,y:t},{x:i,y:s});for(var c=!1,l=0;l<r.length;l++)if("remove"==r[l].type){c=!0,this.stepslimit-=1,this.stepslimit<1&&(this.gameOver(),r.push({type:"gameover"}));break}c||(a=this.getBlock(e,t),this.setBlock(e,t,this.getBlock(i,s)),this.setBlock(i,s,a),r.push({type:"swap",data:{x1:e,y1:t,x2:i,y2:s}})),this.swaping=!1,n(r)}},{key:"triggerEffectSquare",value:function(e,t,i){this.isEliminatable(e,t)&&(this.changeBoardData(e,t,i.changed),this.createEffectSquare(e,t,i))}},{key:"zhulouluoDibuPanding",value:function(){for(var e=0;e<this.cols;e++)13==this.getBlock(e,this.rows-1)&&this.gameOver()}}]),e}();i["default"]=h},{}],2:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./max/utilities"),h=e("./max/display.js"),c=e("./t0.js"),l=function(e){function t(e){s(this,t);var i=e.board.boss,a=35+67*i.x+32*i.w,r=260+67*i.y+32*i.h,l=n(this,Object.getPrototypeOf(t).call(this,o.assets[c.bossAssets[i.type]],(0,h.calcPx)(a),(0,h.calcPx)(r,1)));l.layer=5,l.width=67*(i.w+1)-10,l.height=67*(i.h+1)-6,l.ox=a-parseInt(l.width/2)+2;var u=r-parseInt(l.height/2);return l.r1=(0,h.rectangle)(l.width,11,"white","none",0,a,u+10),l.r1.layer=6,l.hpw=l.width-4,l.r2=(0,h.rectangle)(l.hpw,8,"red","none",0,a,u+10),l.r2.layer=7,l.hp=i.hp,l.view=e,l}return a(t,e),r(t,[{key:"myAction",value:function(){var e=parseInt(this.view.bosshp/this.hp*this.hpw);this.r2.width=(0,h.calcPx)(e),this.r2.x=(0,h.calcPx)(this.ox+parseInt(e/2))}}]),t}(h.Sprite);i["default"]=l},{"./max/display.js":17,"./max/utilities":20,"./t0.js":32}],3:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.BuyCommodity=void 0;var o=e("./sell.js"),h=e("./paragraph.js"),c=e("./max/display.js"),l=e("./max/utilities.js");i.BuyCommodity=function(e){function t(e,i){function a(){f.cnum.content=f.num,f.cost.content="总价:"+r*f.num}s(this,t);var r=o.commodityprice[e],u=400,g=n(this,Object.getPrototypeOf(t).call(this,l.assets["images/grid.png"],(0,c.calcPx)(270),(0,c.calcPx)(u,1))),f=g;return g.father=i,g.show=!0,i.buycommodityshow=!0,g.width=400,g.height=300,g.layer=18,g.num=1,g.fanhui=(0,c.newMyButton)(l.assets["images/main_return.png"],420,u-110,50,50,20),g.fanhui.release=function(){g.removeAll()},g.icon=(0,c.spritE)(l.assets[o.commodityicon[e]],150,u-90,80,80,20),g.tishi=(0,c.text)(o.commodityname[e],"35px 微软雅黑","black",270,u-100,20),g.minus=(0,c.newMyButton)(l.assets["images/shop_minus.png"],170,u,50,50,20),g.minus.release=function(){1!=g.num&&(g.num--,a())},g.minus.pressinG=function(){1!=g.num&&(g.num--,a())},g.add=(0,c.newMyButton)(l.assets["images/shop_add.png"],370,u,50,50,20),g.add.release=function(){99!=g.num&&(g.num++,a())},g.add.pressinG=function(){99!=g.num&&(g.num++,a())},g.numframe=(0,c.spritE)(l.assets["images/shop_numframe.png"],270,u,100,60,20),g.cnum=(0,c.text)(1,"40px 微软雅黑","white",280,u-7,25),g.cnum.align="center",g.cost=(0,c.text)("总价:"+r,"30px 微软雅黑","black",280,u-60,20),g.goumai=(0,c.newMyButton)(l.assets["images/shop_goumai.png"],270,u+80,100,50,20),g.goumai.release=function(){},g.wenhao=(0,c.newMyButton)(l.assets["images/wenhao.png"],400,u+100,60,60,20),g.wenhao.release=function(){g.jieshaoshow?g.removeJieshao():(g.jieshaobg=(0,c.spritE)(l.assets["images/fk_ice1.png"],270,u+250,400,200,20),g.jieshaoshow=!0,g.jieshaotext=(0,h.newParagraph)(o.propintroduce[e],{x:310,y:u+220,layer:25,size:30,width:380}))},g}return a(t,e),r(t,[{key:"removeJieshao",value:function(){c.stage.removeTrue(this.jieshaobg,this.jieshaotext),this.jieshaoshow=!1}},{key:"removeAll",value:function(){this.jieshaoshow&&this.removeJieshao(),c.stage.removeTrue(this.icon,this.fanhui,this.tishi,this.minus,this.add,this.numframe,this.cnum,this.cost,this.goumai,this.wenhao,this),this.father.buycommodityshow=!1}}]),t}(c.Sprite)},{"./max/display.js":17,"./max/utilities.js":20,"./paragraph.js":23,"./sell.js":28}],4:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{
value:!0}),i.ChooseHero=void 0;var a=e("./max/display.js"),r=e("./max/utilities.js"),o=e("./t0.js"),h=(e("./chooselevel.js"),e("./herocard.js")),c=e("./knapsack.js"),l=e("./index.js");i.ChooseHero=function(){function e(t,i,n){var u=this;s(this,e),i&&(l.index_g.back.alpha=1,l.index_g.back.release=function(){u.removeAll(),"herocard"==i?l.index_g.content=new h.HeroCard(n):"knapsack"==i?l.index_g.content=new c.Knapsack:l.index_g.hideBackAndIndex()}),l.index_g.index.alpha=1,l.index_g.bgmoveable=!1,this.bg=(0,a.spritE)(r.assets["images/herotujian_di.png"],270,480,520,710,10),(0,a.text)("关卡"+t+" 选择英雄","40px 微软雅黑","white",270,40,15,this.bg);var g=[{id:7,level:3,energy:10},{id:8,level:3,energy:10},{id:9,level:3,energy:10},{id:10,level:3,energy:10},{id:11,level:3,energy:10},{id:12,level:3,energy:10}],f=["魔爆师","贤者","魔导师","神偷","弩炮手","符文音阶少女"];this.ts=[],this.bt=[];for(var p=0;p<f.length;p++){this.ts.push((0,a.text)(f[p],"30px 微软雅黑","white",350,750-100*p,20));var d=(0,a.newMyButton)(r.assets[o.boardAssets[g[p].id]],200,750-100*p,80,80,20);d.id=p,d.release=function(){(0,o.gameSetup)(t,g[this.id])},this.bt.push(d)}}return n(e,[{key:"removeAll",value:function(){a.stage.removeTrue(this.bg,this.ts,this.bt)}}]),e}()},{"./chooselevel.js":5,"./herocard.js":10,"./index.js":12,"./knapsack.js":14,"./max/display.js":17,"./max/utilities.js":20,"./t0.js":32}],5:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.ChooseLevel=void 0;var n=e("./max/display.js"),a=e("./max/utilities.js"),r=e("./choosehero.js"),o=e("./index.js"),h=e("./information.js");i.ChooseLevel=function c(){s(this,c),this.ts=[],this.bt=[];for(var e=o.record_g.levels,t=void 0,i=void 0,l=o.index_g.bg.sourceY,u=0;u<h.BOARDDATA.length;u++){t=h.BOARDDATA[u].x,i=h.BOARDDATA[u].y,this.ts.push((0,n.text)("第"+(u+1)+"关","20px 微软雅黑","black",t,i+50+l,7));var g=void 0,f=e[u+1];"boss"==h.BOARDDATA[u].mission.type?g=f>0?a.assets["images/boss_tongguan.png"]:a.assets["images/boss_live.png"]:f>0?(g=a.assets["images/guoguan1x.png"],f>1&&(n.stage.add((0,n.spritE)(a.assets["images/guoguan2x.png"],t+5,i+l,15,35,6)),f>2&&n.stage.add((0,n.spritE)(a.assets["images/guoguan3x.png"],t+12,i+l+2,20,28,6)))):g=a.assets["images/guanqia.png"];var p=(0,n.newMyButton)(g,t,i+l,60,90,5);p.id=h.BOARDDATA[u].level,p.release=function(){o.index_g.bg.moved||o.index_g.bg.movetime||!o.index_g.bgmoveable||(o.index_g.content=new r.ChooseHero(this.id))},this.bt.push(p)}}},{"./choosehero.js":4,"./index.js":12,"./information.js":13,"./max/display.js":17,"./max/utilities.js":20}],6:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.Commodity=void 0;var o=e("./max/display.js"),h=e("./max/utilities.js"),c=e("./sell.js"),l=e("./buycommodity.js");i.Commodity=function(e){function t(e,i,a,r){s(this,t);var u=n(this,Object.getPrototypeOf(t).call(this,h.assets["images/fk_ice3.png"],(0,o.calcPx)(i),(0,o.calcPx)(a,1)));return u.width=(0,o.calcPx)(150),u.height=(0,o.calcPx)(150,1),u.layer=12,u.interactive=!0,u.release=function(){r.bg.moved||r.bg.movetime||r.buycommodityshow||(this.content=new l.BuyCommodity(this.id,r),o.stage.add(this.content))},u.id=e,u.price=c.commodityprice[e],u.icon=(0,o.spritE)(h.assets[c.commodityicon[e]],i,a-30,70,70,15),u.name=(0,o.text)(c.commodityname[e],"25px 微软雅黑","black",i,a+25,15),u.pricetx=(0,o.text)(u.price,"25px 微软雅黑","black",i,a+50,15),u}return a(t,e),r(t,[{key:"removeAll",value:function(){this.content&&this.content.show&&this.content.removeAll(),o.stage.removeTrue(this.bg,this.icon,this.name,this.pricetx,this)}}]),t}(o.Sprite)},{"./buycommodity.js":3,"./max/display.js":17,"./max/utilities.js":20,"./sell.js":28}],7:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t,i,s,n){var a=new l(e,t,i,s,n);return c.stage.add(a),a}function o(e){for(var t=[],i=0;i<e.length;i++){var s=(0,c.text)(e[i],"40px 微软雅黑","black",400*Math.random()+100,700+50*i,15);s.myAction=function(){this.y-=2,this.y<100&&(this.y=800,this.x=400*Math.random()+100)},t.push(s)}return t}var h=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.newFloatText=r,i.forNewFloatText=o;var c=(e("./max/utilities"),e("./max/display.js")),l=function(e){function t(e,i,a,r,o){s(this,t),i=(0,c.calcPx)(i),a=(0,c.calcPx)(a,1);var h=(0,c.calcPx)(40),l=h+"px 微软雅黑",u=n(this,Object.getPrototypeOf(t).call(this,e,l,r||"white",i,a));return u.layer=15,u.count=30,u.show=o,c.stage.children.forEach(function(e){e instanceof t&&(e.y-=(0,c.calcPx)(35,1))}),u}return a(t,e),h(t,[{key:"myAction",value:function(){this.parent&&!this.show&&(this.count--,this.count||this.parent.remove(this),this.alpha=1-1/this.count),this.y-=2}}]),t}(c.Text)},{"./max/display.js":17,"./max/utilities":20}],8:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0}),i.Gameclear=void 0;var r=e("./max/display.js"),o=e("./max/utilities.js"),h=e("./t0.js"),c=e("./index.js");i.Gameclear=function(e){function t(e){s(this,t);var i=n(this,Object.getPrototypeOf(t).call(this,o.assets["images/gameclear.png"],(0,r.calcPx)(270),(0,r.calcPx)(480,1)));i.width=(0,r.calcPx)(223),i.height=(0,r.calcPx)(187,1),i.layer=15;var a=e.star,l=e.level;if((!c.record_g.levels[l]||c.record_g.levels[l]<a)&&(c.record_g.levels[l]=a),localStorage.setItem("sanxiao_huoxuan",JSON.stringify(c.record_g)),(0,r.spritE)(o.assets["images/star1.png"],240,485,28,28,16),a>1){var u=(0,r.spritE)(o.assets["images/star1.png"],310,485,28,28,16);u.scaleX=-1,a>2&&(0,r.spritE)(o.assets["images/star2.png"],275,475,36,34,16)}var g=(0,r.newMyButton)(o.assets["images/gameover_fanhui.png"],190,570,100,50,16);g.release=function(){(0,h.gotoIndex)()};var f=(0,r.newMyButton)(o.assets["images/gameclear_xiaguan.png"],350,570,100,50,16);return f.release=function(){(0,h.gameSetup)(l+1,e.hero)},i}return a(t,e),t}(r.Sprite)},{"./index.js":12,"./max/display.js":17,"./max/utilities.js":20,"./t0.js":32}],9:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0}),i.Gameover=void 0;var r=e("./max/display.js"),o=e("./max/utilities.js"),h=e("./t0.js");i.Gameover=function(e){function t(e){s(this,t);var i=n(this,Object.getPrototypeOf(t).call(this,o.assets["images/gameover.png"],(0,r.calcPx)(270),(0,r.calcPx)(480,1)));i.width=(0,r.calcPx)(500),i.height=(0,r.calcPx)(350,1),i.layer=15;var a=(0,r.newMyButton)(o.assets["images/gameover_fanhui.png"],150,600,100,50,16);a.release=function(){(0,h.gotoIndex)()};var c=(0,r.newMyButton)(o.assets["images/gameover_zaici.png"],390,600,100,50,16);return c.release=function(){(0,h.gameSetup)(e.level,e.hero)},i}return a(t,e),t}(r.Sprite)},{"./max/display.js":17,"./max/utilities.js":20,"./t0.js":32}],10:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){switch(e){case 7:case 8:case 9:case 10:case 11:return!0}}function a(e){return e>6?e-6:e}function r(e){var t=void 0,i=void 0,s=void 0;return i=e>6?e-6:e,{has:t,id:i,site:s}}var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.HeroCard=void 0;var h=e("./max/utilities"),c=e("./max/display.js"),l=e("./paragraph.js"),u=e("./knapsack_prop.js"),g=e("./knapsack.js"),f=e("./t0.js"),p=e("./index.js"),d=e("./herohandbook.js"),m=e("./shop.js");e("./chooselevel.js"),i.HeroCard=function(){function e(t,i){var o=this;s(this,e),i&&(p.index_g.back.alpha=1,p.index_g.back.release=function(){o.removeAll(),"knapsack"==i?p.index_g.content=new g.Knapsack:"herohandbook"==i?p.index_g.content=new d.HeroHandBook:p.index_g.hideBackAndIndex()}),p.index_g.index.alpha=1,p.index_g.bgmoveable=!1,p.index_g.title="herocard",this.bg=(0,c.spritE)(h.assets["images/herotujian_di.png"],270,480,520,710,14),this.icon=(0,c.spritE)(h.assets[f.boardAssets[t]],120,300,200,200,15),this.name=(0,c.text)(d.heroif[t].name,"30px 微软雅黑","black",300,200,15),this.jianjie=(0,l.newParagraph)("英雄简介",{size:30,color:"black",x:390,y:300,layer:16});var v=!1,y=1,k=3;if(v&&k>y){var b=(0,c.newMyButton)(h.assets["images/hero_levelup.png"],270,700,100,100,20);b.release=function(){},this.lev=b}else v||!function(){var e=new u.KnapsackProp;o.prop=e;var i=0,s=10,l=10,g=(0,c.newMyButton)(h.assets["images/hero_hecheng.png"],150,610,100,100,15);g.release=function(){e.showing||(i>=l||n(t)&&i+s>=l)&&r(t)},o.hecheng=g;var f=(0,c.text)("专属碎片","30px 微软雅黑","blue",100,680,15);f.interactive=!0,f.release=function(){e.showing||e.show("herocard",a(t),t)},o.zssp=f,o.zssl=(0,c.text)(":"+i+"/"+l,"30px 微软雅黑","black",205,680,15),o.zsdaoju=(0,c.text)("专属道具:","30px 微软雅黑","black",150,720,15);var d=(0,c.text)("xxx","30px 微软雅黑","blue",150,760,15);d.interactive=!0,d.release=function(){e.showing||e.show("herocard",r(t).id,t)},o.zsdj=d;var v=(0,c.newMyButton)(h.assets["images/hero_chouqu.png"],400,610,100,100,15);v.release=function(){e.showing||(p.index_g.content=new m.Shop("herocard",t,"raffle"),o.removeAll())},o.chouqu=v}()}return o(e,[{key:"removeAll",value:function(){this.prop&&this.prop.showing&&this.prop.hide(),c.stage.removeTrue(this.bg,this.icon,this.name,this.jianjie,this.lev,this.hecheng,this.zssp,this.zssl,this.zsdaoju,this.zsdj,this.chouqu)}}]),e}()},{"./chooselevel.js":5,"./herohandbook.js":11,"./index.js":12,"./knapsack.js":14,"./knapsack_prop.js":15,"./max/display.js":17,"./max/utilities":20,"./paragraph.js":23,"./shop.js":29,"./t0.js":32}],11:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.HeroHandBook=i.herohandbook_g=i.heroif=void 0;var a=e("./max/utilities"),r=e("./max/display.js"),o=(e("./t0.js"),e("./index.js")),h=(e("./chooselevel.js"),e("./knapsack.js")),c=e("./herocard.js"),l=i.heroif={length:6,7:{id:7,name:"魔爆师",star:3,icon:"images/fk7.png",skillicon:"images/skill.png"},8:{id:8,name:"贤者",star:2,icon:"images/fk8.png",skillicon:"images/skill.png"},9:{id:9,name:"魔导师",star:3,icon:"images/fk9.png",skillicon:"images/skill.png"},10:{id:10,name:"神偷",star:3,icon:"images/fk10.png",skillicon:"images/skill.png"},11:{id:11,name:"弩炮手",star:1,icon:"images/fk11.png",skillicon:"images/skill.png"},12:{id:12,name:"符文音阶少女",star:4,icon:"images/fk12.png",skillicon:"images/skill.png"}};i.herohandbook_g=void 0,i.HeroHandBook=function(){function e(t){function i(e){if(!(d[0].y>100&&e>0||p[p.length-1].y<600&&0>e)){Math.abs(e)>5&&(f.moved=!0);for(var t=0;t<p.length;t++)p[t].movepy=e;for(var t=0;t<d.length;t++)d[t].movepy=e}}function n(){for(var e=[],t=[],i=[],s=[],n=0;n<l.length;n++)switch(l[n+7].star){case 1:e.push(l[n+7]);break;case 2:t.push(l[n+7]);break;case 3:i.push(l[n+7]);break;case 4:s.push(l[n+7])}y.push(e,t,i,s)}var u=this;s(this,e);var g=this,f=(0,r.newMyButton)(a.assets["images/herotujian_di.png"],270,480,520,710,10);f.press=function(){this.pressoy=this.pointy,this.moved=!1},f.moveIn=function(){this.pressoy=this.pointy,this.moved=!1},f.moveOut=function(){this.moved=!1},f.move=function(){i(this.pointy-this.pressoy),this.pressoy=this.pointy},f.release=function(){this.moved&&(this.movetime=10),this.moved=!1},f.myAction=function(){this.movetime>0&&this.movetime--},this.bg=f,t?(o.index_g.back.alpha=1,o.index_g.back.release=function(){1==o.index_g.back.alpha&&(u.removeAll(),"knapsack"==t?o.index_g.content=new h.Knapsack:o.index_g.hideBackAndIndex())}):o.index_g.back.alpha=0,o.index_g.index.alpha=1,o.index_g.bgmoveable=!1,o.index_g.title="herohandbook";var p=[],d=[],m=0,v=130,y=[];n();for(var k=0;k<y.length;k++){var b=Math.ceil(m/3);for(v-=40,d[k]=(0,r.spritE)(a.assets["images/fk_ice3.png"],270,v+180*b,50,30,15,{father:f}),d[k].myAction=function(){this.movepy&&(this.y+=this.movepy,this.movepy=0)},m+=3;m%3;)m++;b++,v-=40;for(var x=0;x<y[k].length;x++){var w=y[k][x].id,_=(0,r.newMyButton)(a.assets[l[w].icon],175*(x%3)+85,v+180*(parseInt(x/3)+b),150,150,15,{father:f});_.id=w,_.myAction=function(){this.movepy&&(this.y+=this.movepy,this.movepy=0)},_.release=function(){if(!f.moved&&!f.movetime){if("herohandbook"!=o.index_g.title){var e=r.buttons.indexOf(this);return void(e>=0&&r.buttons.splice(e,1))}g.removeAll(),o.index_g.content=new c.HeroCard(this.id,"herohandbook")}},p.push(_),m++}}}return n(e,[{key:"removeAll",value:function(){r.stage.removeTrue(this.bg)}}]),e}()},{"./chooselevel.js":5,"./herocard.js":10,"./index.js":12,"./knapsack.js":14,"./max/display.js":17,"./max/utilities":20,"./t0.js":32}],12:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.Index=i.record_g=i.index_g=void 0;var a=e("./max/utilities.js"),r=e("./max/display.js"),o=e("./chooselevel.js"),h=e("./herohandbook.js"),c=e("./herocard.js"),l=e("./shop.js"),u=(e("./othermenu.js"),e("./knapsack.js")),g=e("./information.js"),f=i.index_g=void 0,p=i.record_g=void 0;i.Index=function(){function e(){function t(e){if(!(d.sourceY<=3&&e>0||d.sourceY>=454&&0>e)){Math.abs(e)>5&&(d.moved=!0),d.sourceY-=e,d.sourceY<0?d.sourceY=0:d.sourceY>456&&(d.sourceY=456),m.sourceY=d.sourceY;for(var t=0;t<f.chooselevel.bt.length;t++){var i=456+g.BOARDDATA[t].y+(456-d.sourceY)/1.33;f.chooselevel.bt[t].y=(0,r.calcPx)(i,1),f.chooselevel.ts[t].y=(0,r.calcPx)(i+50,1)}}}var n=this;s(this,e),i.index_g=f=this,f.title="index",i.record_g=p=JSON.parse(localStorage.getItem("sanxiao_huoxuan")),null==p&&(i.record_g=p={levels:[0]}),this.back=(0,r.newMyButton)(a.assets["images/main_return.png"],50,160,60,60,16),this.back.alpha=0,this.index=(0,r.newMyButton)(a.assets["images/main_index.png"],490,160,60,60,16),this.index.alpha=0,this.index.release=function(){1==f.index.alpha&&(n.content&&n.content.removeAll(),n.hideBackAndIndex())},this.bgmoveable=!0;var d=(0,r.bigmap)(a.assets["images/xuanguan_bg1.png"],270,480,540,960,0,0,1280);d.sourceY=456,d.interactive=!0,d.press=function(){this.pressoy=this.pointy,this.moved=!1},d.moveIn=function(){this.pressoy=this.pointy,this.moved=!1},d.moveOut=function(){this.moved=!1},d.move=function(){f.bgmoveable&&(t(this.pointy-this.pressoy),this.pressoy=this.pointy)},d.release=function(){this.moved&&(this.movetime=10),this.moved=!1},d.myAction=function(){this.movetime>0&&this.movetime--},this.bg=d;var m=(0,r.bigmap)(a.assets["images/xuanguan_bg1bu.png"],270,480,540,960,6,0,1280);m.sourceY=d.sourceY;var v=11,y=9;(0,r.spritE)(a.assets["images/main_touxiangdiban.png"],50,50,100,100,2);var k=(0,r.newMyButton)(a.assets[h.heroif[v].icon],45,50,80,80,3);k.release=function(){d.moved||d.movetime||!n.bgmoveable||(n.content&&n.content.removeAll(),n.content=new c.HeroCard(v))},(0,r.spritE)(a.assets["images/main_touxiangframe.png"],50,50,100,100,5),(0,r.spritE)(a.assets["images/main_baoshihuang.png"],65,10,20,20,6),(0,r.spritE)(a.assets["images/main_jinengdiban.png"],120,30,60,60,2),(0,r.spritE)(a.assets[h.heroif[v].skillicon],120,30,60,60,3),(0,r.spritE)(a.assets["images/main_jinengkuang.png"],120,30,60,60,4),(0,r.spritE)(a.assets["images/main_dengji.png"],97,53,20,20,6),(0,r.text)(y,"15px 微软雅黑","white",97,50,7);var b=(0,r.newMyButton)(a.assets["images/main_renwu.png"],55,180,105,100,5);b.release=function(){!n.bgmoveable||d.moved||d.movetime||console.log("任务按钮被点击了")};var x=(0,r.newMyButton)(a.assets["images/main_wenhao.png"],55,310,105,100,5);x.release=function(){!n.bgmoveable||d.moved||d.movetime||console.log("问号被点击了")};var w=(0,r.newMyButton)(a.assets["images/main_tujian.png"],100,890,190,134,50);w.name="hero",w.release=function(){d.moved||d.movetime||(n.content&&n.content.removeAll(),n.content=new h.HeroHandBook)};var _=(0,r.newMyButton)(a.assets["images/main_beibao.png"],270,890,116,111,50);_.release=function(){d.moved||d.movetime||(n.content&&n.content.removeAll(),n.content=new u.Knapsack)};var j=(0,r.newMyButton)(a.assets["images/main_shangcheng.png"],450,890,112,106,50);j.release=function(){d.moved||d.movetime||(n.content&&n.content.removeAll(),n.content=new l.Shop)},this.chooselevel=new o.ChooseLevel}return n(e,[{key:"removeMenu",value:function(){this.menu&&this.menu.showing&&this.menu.hide()}},{key:"hideBackAndIndex",value:function(){this.bgmoveable=!0,this.back.alpha=0,this.index.alpha=0,f.title="index"}}]),e}()},{"./chooselevel.js":5,"./herocard.js":10,"./herohandbook.js":11,"./information.js":13,"./knapsack.js":14,"./max/display.js":17,"./max/utilities.js":20,"./othermenu.js":22,"./shop.js":29}],13:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=[[1,5,5,5,5,5,5,1],[1,1,5,5,5,5,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,0],[0,0,1,1,1,1,0,0],[0,0,0,1,1,0,0,0]],n=[[1,1,1,1,1,1,1,1],[1,1,1,1,2,1,1,1],[1,1,1,1,1,1,2,2],[1,1,1,2,2,1,1,1],[1,1,2,2,2,1,1,1],[1,1,1,1,1,2,1,2],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1]],a=[[5,1,5,5,5,5,1,5],[5,1,1,5,5,1,1,5],[1,1,1,1,1,1,1,1],[1,1,5,1,1,5,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[0,1,1,1,1,1,1,0],[0,0,1,1,1,1,0,0]],r=[[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,3,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,3,1,1,1],[1,1,1,1,1,1,1,1],[3,1,1,1,1,1,1,3]],o=[[1,1,1,2,1,1,1,1],[1,1,1,1,2,1,1,1],[1,1,1,1,1,2,1,1],[2,1,2,1,1,1,1,1],[1,1,1,2,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1]],h=[[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[4,4,4,1,1,4,4,4],[4,5,4,1,1,4,5,4],[4,4,4,1,1,4,4,4],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1]];i.BOARDDATA=[{stepslimit:10,mission:{type:"score",data:5e4},level:1,x:200,y:225},{stepslimit:12,mission:{type:"eliminate",data:[{type:0,data:20},{type:2,data:20}]},level:2,boarddata:s,x:125,y:125},{time:60,mission:{type:"eliminate",data:[{type:6,data:4}]},level:3,x:140,y:5,surface:r},{time:60,mission:{type:"eliminate",data:[{type:5,data:10}]},level:4,boarddata:n,surface:o,x:240,y:-80},{stepslimit:15,boarddata:a,mission:{type:"boss",data:{hp:50,type:0,x:3,y:5,x2:4,y2:5}},level:5,x:360,y:-145},{mission:{type:"escape",data:{x:4,y:6}},level:6,x:430,y:-255},{time:120,mission:{type:"eliminate",data:[{type:7,data:3}]},level:7,x:410,y:-390},{mission:{type:"cellect",data:3},stepslimit:20,level:8,x:310,y:-490},{mission:{type:"rescue",data:[{x:1,y:4},{x:6,y:4}]},time:180,level:9,x:260,y:-620,surface:h},{mission:{type:"boss",data:{hp:50,type:1,x:3,y:3,x2:4,y2:4}},level:10,x:350,y:-750}]},{}],14:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){t?(e.alpha=0,e.interactive=!1):(e.alpha=1,e.interactive=!0)}function a(e){return e>=7&&13>=e?!0:void 0}function r(e){return e>=1&&6>=e?!0:void 0}function o(e){return e>=14&&15>=e?!0:void 0}var h=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.Knapsack=i.prop_g=i.showprops=void 0,i.showButton=n,i.isDebris=a,i.isEquip=r,i.isProp=o;var c=e("./max/utilities"),l=e("./max/display.js"),u=e("./knapsack_prop.js"),g=e("./index.js"),f=(e("./chooselevel.js"),i.showprops=void 0),p=i.prop_g={1:{name:"魔爆法杖",icon:"images/fk0.png",introduce:"合成魔爆师的专属装备"},2:{name:"百科全书",icon:"images/fk1.png",introduce:"合成贤者的专属装备"},3:{name:"魔导师之仗",icon:"images/fk2.png",introduce:"合成魔导师的专属装备"},4:{name:"神偷眼罩",icon:"images/fk3.png",introduce:"合成神偷的专属装备"},5:{name:"弩炮",icon:"images/fk4.png",introduce:"合成弩炮手的专属装备"},6:{name:"爱的音符",icon:"images/fk5.png",introduce:"合成符文音阶少女的专属装备"},7:{name:"万能碎片",icon:"images/fk6.png",introduce:"合成英雄的碎片，当专属碎片不足时替代专属碎片"},8:{name:"魔爆师碎片",icon:"images/fk11.png",introduce:"合成魔爆师的专属碎片"},9:{name:"贤者碎片",icon:"images/fk11.png",introduce:"合成贤者的专属碎片"},10:{name:"魔导师碎片",icon:"images/fk11.png",introduce:"合成魔导师的专属碎片"},11:{name:"神偷碎片",icon:"images/fk11.png",introduce:"合成神偷的专属碎片"},12:{name:"弩炮手碎片",icon:"images/fk11.png",introduce:"合成弩炮手的专属碎片"},13:{name:"符文音阶少女碎片",icon:"images/fk11.png",introduce:"合成符文音阶少女的专属碎片"},14:{name:"技能药水",icon:"images/fk11.png",introduce:"使用后增加一点职业技能点"},15:{name:"能量药水",icon:"images/fk11.png",introduce:"增加冒险家50%的能量"}};i.Knapsack=function(){function e(){function t(e){e&&S!=e&&(S=e,i.showprops=f=[],y.forEach(function(t){e(t)&&f.push(t)}),x=1,b=Math.ceil(f.length/16)||1,h(1))}function h(e){var t=16*(e-1),i=void 0;k=f.length-t,k>16&&(k=16);for(var s=0;k>s;s++)i=w[s],i.createFromImage(c.assets[p[f[s+t]].icon]),i.width=(0,l.calcPx)(100),i.height=(0,l.calcPx)(100,1),i.site=t+s,i.interactive=!0;if(16>k&&w.length>k)for(var s=k;16>s;s++)i=w[s],i.createFromImage(c.assets["images/trans.png"]),i.interactive=!1;e==b?n(O,1):e==b-1&&n(O),1==e?n(B,1):2==e&&n(B)}function d(e){Math.abs(e)<25||(m.moved=!0,e>0&&x>1?h(--x):0>e&&b>x&&h(++x))}s(this,e);var m=(0,l.newMyButton)(c.assets["images/herotujian_di.png"],270,480,520,710,10);m.press=function(){this.pressox=this.pointx,this.moved=!1},m.moveIn=function(){this.pressox=this.pointx,this.moved=!1},m.moveOut=function(){this.moved=!1},m.move=function(){d(this.pointx-this.pressox),this.pressox=this.pointx},m.release=function(){this.moved&&(this.movetime=10),this.moved=!1},m.myAction=function(){this.movetime&&this.movetime--},this.bg=m,g.index_g.back.alpha=0,g.index_g.index.alpha=1,g.index_g.bgmoveable=!1,g.index_g.title="knapsack",this.title=(0,l.text)("背包","50px 微软雅黑","black",270,80,12);var v=new u.KnapsackProp(this);this.propf=v;var y=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,15,15];i.showprops=f=y.concat();var k=f.length,b=Math.ceil(k/16)||1,x=1;k=k>16?16:k;var w=[];this.dj=w;for(var _=0;k>_;_++){var j=(0,l.newMyButton)(c.assets["images/trans.png"],_%4*130+75,150*parseInt(_/4)+250,100,100,15);j.site=_,j.release=function(){m.moved||m.movetime>0||v.showing||v.show("knapsack",this.site)},w.push(j)}var B=(0,l.newMyButton)(c.assets["images/fanye_prev.png"],205,820,70,70,15);B.alpha=0,B.release=function(){1==x||m.movetime||v.showing||h(--x)},this.pl=B;var O=(0,l.newMyButton)(c.assets["images/fanye_next.png"],335,820,70,70,15);O.alpha=0,O.release=function(){x==b||m.movetime||v.showing||h(++x)},this.pr=O,h(1);var S="all",C=(0,l.newMyButton)(c.assets["images/beibao_all.png"],100,150,100,50,15);C.release=function(){"all"!=S&&(S="all",i.showprops=f=y.concat(),x=1,b=Math.ceil(f.length/16)||1,h(1))},this.all=C;var E=(0,l.newMyButton)(c.assets["images/beibao_prop.png"],220,150,100,50,15);E.release=function(){t(o)},this.prop=E;var P=(0,l.newMyButton)(c.assets["images/beibao_debris.png"],340,150,100,50,15);P.release=function(){t(a)},this.debris=P;var M=(0,l.newMyButton)(c.assets["images/beibao_equip.png"],460,150,100,50,15);M.release=function(){t(r)},this.equip=M}return h(e,[{key:"removeAll",value:function(){this.propf.showing&&this.propf.hide(),l.stage.removeTrue(this.bg,this.title,this.pl,this.pr,this.dj,this.all,this.prop,this.debris,this.equip)}}]),e}()},{"./chooselevel.js":5,"./index.js":12,"./knapsack_prop.js":15,"./max/display.js":17,"./max/utilities":20}],15:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.KnapsackProp=void 0;var a=e("./max/utilities"),r=e("./max/display.js"),o=e("./paragraph.js"),h=e("./knapsack.js"),c=e("./index.js"),l=e("./choosehero.js"),u=e("./shop.js"),g=e("./herocard.js"),f=e("./herohandbook.js"),p=(i.KnapsackProp=function(){function e(){var t=this;s(this,e);var i=this;this.bg=(0,r.newMyButton)(a.assets["images/fk_ice1.png"],270,450,500,600,22),this.bg.release=function(){t.hide()},this.bottombg=(0,r.newMyButton)(a.assets["images/trans.png"],270,480,540,960,21),this.bottombg.release=function(){t.showing&&t.hide()},this.propicon=(0,r.spritE)(a.assets["images/fk0.png"],110,280,100,100,25),this.propname=(0,r.text)("1号道具","50px 微软雅黑","black",270,280,25),this.jieshao=(0,o.newParagraph)("道具简介",{size:30,width:400,x:270,y:370,layer:25}),this.chuchu=(0,r.text)("出处：","30px 微软雅黑","black",100,510,25),this.use=(0,r.newMyButton)(a.assets["images/beibao_use.png"],270,650,80,50,25),this.use.release=function(){t.usE()},this.compound=(0,r.newMyButton)(a.assets["images/beibao_compound.png"],270,650,80,50,25),this.compound.release=function(){t.compounD()},this.produce=[];for(var n=0;5>n;n++){var h=(0,r.text)("","30px 微软雅黑","blue",90+n%5*80,550+50*parseInt(n/5),25);h.interactive=!0,h.release=function(){c.index_g.content.removeAll(),c.index_g.content=new l.ChooseHero(this.level,i.ui,i.heroid)},this.produce.push(h)}this.gk=(0,r.text)("关卡：","30px 微软雅黑","black",270,510,25),this.rf=(0,r.text)("抽取","30px 微软雅黑","blue",175,510,25),this.rf.release=function(){c.index_g.content.removeAll(),c.index_g.content=new u.Shop(t.ui,t.heroid,"raffle")},this.hide()}return n(e,[{key:"compounD",value:function(){var e=void 0;return 7==this.id?(c.index_g.content.removeAll(),void(c.index_g.content=new f.HeroHandBook("knapsack"))):(this.id<7?e=this.id+6:this.id>7&&(e=this.id-1),c.index_g.content.removeAll(),void(c.index_g.content=new g.HeroCard(e,"knapsack")))}},{key:"hide",value:function(){this.bg.alpha=0,this.propicon.source=a.assets["images/trans.png"],this.propname.content="",this.chuchu.content="",this.gk.content="",this.rf.content="",this.rf.interactive=!1,this.jieshao.removeAll(),this.use.alpha=0,this.use.interactive=!1,this.compound.alpha=0,this.compound.interactive=!1;for(var e=0;e<this.produce.length;e++)this.produce[e].content="",this.produce[e].interactive=!1;this.bottombg.interactive=!1,this.bg.interactive=!1,this.showing=!1}},{key:"show",value:function(e,t,i){this.showing=!0,"knapsack"==e&&(this.site=t,t=h.showprops[t]),this.ui=e,this.heroid=i,this.id=t,this.bg.alpha=1,this.propicon.createFromImage(a.assets[h.prop_g[t].icon]),this.propicon.width=(0,r.calcPx)(100),this.propicon.height=(0,r.calcPx)(100,1),this.propname.content=h.prop_g[t].name,this.jieshao.setText(h.prop_g[t].introduce),this.bottombg.interactive=!0,this.bg.interactive=!0,"knapsack"==e&&((0,h.isProp)(t)?(this.use.alpha=1,this.use.interactive=!0):((0,h.isDebris)(t)||(0,h.isEquip)(t))&&(this.compound.alpha=1,this.compound.interactive=!0)),this.chuchu.content="出处：";var s=p[t],n=void 0,o=void 0,u=void 0;if(s){if(n=s.raffle,s.level.length>this.produce.length){for(o=0;o<this.produce.length;o++)u=s.level[o],this.produce[o].content=this.produce[o].level=u,this.produce[o].interactive=!0;for(;o<s.level.length;o++){u=s.level[o];var g=(0,r.text)(u,"30px 微软雅黑","blue",90+o%5*80,550+50*parseInt(o/5),25);g.level=u,g.interactive=!0,g.release=function(){c.index_g.content.removeAll(),c.index_g.content=new l.ChooseHero(this.level-1,e,i)},this.produce.push(g)}}else for(o=0;o<s.level.length;o++)u=s.level[o],this.produce[o].content=this.produce[o].level=u,this.produce[o].interactive=!0;o&&n?(this.rf.content="抽取",this.rf.interactive=!0,this.gk.content="关卡：",this.gk.x=270):n?(this.rf.content="抽取",this.rf.interactive=!0):o&&(this.gk.content="关卡：",this.gk.x=190)}}},{key:"usE",value:function(){this.id}}]),e}(),{1:{level:[1,211,354,447,123,2],raffle:1},2:{level:[1,211,354,447,123,2],raffle:1}})},{"./choosehero.js":4,"./herocard.js":10,"./herohandbook.js":11,"./index.js":12,"./knapsack.js":14,"./max/display.js":17,"./max/utilities":20,"./paragraph.js":23,"./shop.js":29}],16:[function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}var n=e("./t0.js"),a=s(n);(0,a["default"])()},{"./t0.js":32}],17:[function(e,t,i){"use strict";function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(){var e=arguments.length<=0||void 0===arguments[0]?{id:"canvas",width:256,height:256,border:"1px dashed black",backgroundColor:"white",rw:1,rh:1}:arguments[0],t=e.id,s=void 0===t?"canvas":t,n=e.width,a=void 0===n?256:n,r=e.height,o=void 0===r?256:r,h=(e.border,e.backgroundColor),c=void 0===h?"white":h,l=e.rw,u=void 0===l?1:l,g=e.rh,f=void 0===g?1:g;document.body.style.margin=0;var p=document.createElement("canvas");return p.id=s,
p.width=a,p.height=o,i.bili_w=Y=u,i.bili_h=X=f,p.style.border=null,p.style.display="block",p.style.backgroundColor=c,p.ctx=p.getContext("2d"),p.ctx.globalAlpha=0,document.body.appendChild(p),i.canvas_display=T=p,p}function o(e){function t(s,n){s.visible&&s.gx<e.width+s._width&&s.gx+s._width>=-s._width&&s.gy<e.height+s._height&&s.gy+s._height>=-s._height&&(i.save(),i.translate(s.x,s.y),i.rotate(s.rotation),i.scale(s.scaleX,s.scaleY),s.parent&&(i.globalAlpha=s.alpha*s.parent.alpha),s.shadow&&(i.shadowColor=s.shadowColor,i.shadowOffsetX=s.shadowOffsetX,i.shadowOffsetY=s.shadowOffsetY,i.shadowBlur=s.shadowBlur),s.blendMode&&(i.globalCompositeOperation=s.blendMode),s.render&&s.render(i),s.children&&s.children.length>0&&(i.translate(-s._offsetX,-s._offsetY),s.children.forEach(function(e){t(e)})),i.restore())}var i=e.ctx;i.clearRect(0,0,e.width,e.height),t(A,1)}function h(e,t){function i(n){n.visible&&n.gx<e.width+n._width&&n.gx+n._width>=-n._width&&n.gy<e.height+n._height&&n.gy+n._height>=-n._height&&(s.save(),void 0!=n.previousX?n.renderX=(n.x-n.previousX)*t+n.previousX:n.renderX=n.x,void 0!=n.previousY?n.renderY=(n.y-n.previousY)*t+n.previousY:n.renderY=n.y,s.translate(n.renderX,n.renderY),s.rotate(n.rotation),s.scale(n.scaleX,n.scaleY),n.parent&&(s.globalAlpha=n.alpha*n.parent.alpha),n.shadow&&(s.shadowColor=n.shadowColor,s.shadowOffsetX=n.shadowOffsetX,s.shadowOffsetY=n.shadowOffsetY,s.shadowBlur=n.shadowBlur),n.blendMode&&(s.globalCompositeOperation=n.blendMode),n.render&&n.render(s),n.children&&n.children.length>0&&n.children.forEach(function(e){i(e)}),s.restore())}var s=e.ctx;s.clearRect(0,0,e.width,e.height),i(A)}function c(e){function t(t){e.gotoAndStop(t)}e.show=t}function l(){function e(t){t.previousX=t.x,t.previousY=t.y,t.children&&t.children.length>0&&t.children.forEach(function(t){e(t)})}A.children.forEach(function(t){e(t)})}function u(e,t,i,s,n,a,r){e=B(e),t=B(t,1),a=B(a),r=B(r,1);var o=new I(e,t,i,s,n,a,r);return A.addChild(o),o}function g(e,t,i,s,n,a){var r=new D(e,t,i,s,n,a);return A.addChild(r),r}function f(e,t,i,s,n,a){var r=new H(e,t,i,s,n,a);return A.addChild(r),r}function p(e,t,i,s,n,a,r){s=B(s),n=B(n,1);var o=parseInt(t);if(o>0){var h=parseInt(o*Y);t=t.replace(o,h)}var c=new q(e,t,i,s,n,a);return r?r.addChild(c):A.addChild(c),c}function d(){for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];var s=new(Function.prototype.bind.apply(F,[null].concat(t)));return A.addChild(s),s}function m(e,t,i,s){var n=new W(e,t,i,s),a=s&&s.father||A;return a.addChild(n),n}function v(e,t,i,s,n,a,r){t=B(t),i=B(i,1),s=B(s),n=B(n,1);var o=m(e,t,i,r);return o.width=s||0,o.height=n||0,o.layer=a||0,o}function y(e,t,i,s,n,a,r){var o=v(e,t,i,s,n,a,r);return o.interactive=!0,o}function k(e,t,i,s,n){var a={};return a.image=e,a.x=t,a.y=i,a.width=s,a.height=n,a}function b(e,t,i,s){var n={};return n.image=e,n.data=t,n.width=i,n.height=s,n}function x(e,t,i){var s=new z(e,t,i);return A.addChild(s),s}function w(e,t,i,s,n,a,r,o){t=B(t),i=B(i,1),s=B(s),n=B(n,1);var h=new R(e,t,i,s,n,a,r,o);return A.add(h),h}function _(){for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];t.forEach(function(e){e.parent.removeChild(e)})}function j(e){e.press=e.press||void 0,e.release=e.release||void 0,e.over=e.over||void 0,e.out=e.out||void 0,e.tap=e.tap||void 0,e.state="up",e.action="",e.longpressed=e.pressed=e.hoverOver=!1,e.tapnum=e.overtime=0,e.downTime=null;var t=350;e.update=function(i){var s=i.hitTestSprite(e);e.pointx=i.x,e.pointy=i.y,s?i.isDown?("out"==e.state?(e.moveIn&&e.moveIn(e),e.pressed=!0,e.action="pressed",e.downTime=Date.now()):"up"==e.state&&(e.downTime=Date.now()),e.state="down",e instanceof z&&(3===e.frames.length?e.gotoAndStop(2):e.gotoAndStop(1))):i.isUp&&("down"==e.state?e.state="up":(e.state="over",e.over&&e.over(e)),e.frames&&3===e.frames.length&&e instanceof z&&e.gotoAndStop(1)):(e instanceof z&&e.gotoAndStop(0),"down"==e.state&&e.moveOut&&e.moveOut(e),e.state="out",e.longpressed=e.pressed=!1,e.downTime&&(e.downTime=null)),"down"===e.state&&(!e.pressed&&e.press&&e.press(e),e.pressed=!0,e.action="pressed",null==e.downTime&&(e.downTime=i.downTime),Math.abs(e.pointx-e.pointpx)<5&&Math.abs(e.pointy-e.pointpy)<5?(e.downTime?e.elapsedTime=Date.now()-e.downTime:e.elapsedTime=0,e.elapsedTime>800&&(e.longPress&&!e.longpressed&&(e.longPress(e),e.longpressed=!0),e.pressinG&&e.pressinG())):e.move&&e.move(e)),(i.elapsedTime>t||Date.now()-e.overtime>t)&&(e.tapnum=0),"up"===e.state&&(i.prepDown>0&&(i.prepDown--,e.pressed&&(i.tapped?(e.tapnum++,2==e.tapnum&&e.doubleClick?(e.tapnum=0,e.doubleClick(e)):e.tap&&e.tap(e)):e.longpressed&&e.longClick&&e.longClick(e),e.release&&e.release(e))),e.longpressed=e.pressed=!1,e.downTime=null,e.action="released",e.overtime=Date.now()),"out"===e.state&&e.out&&(e.out(e),e.longpressed=e.pressed=!1,e.downTime=null),e.pointpx=e.pointx,e.pointpy=e.pointy}}function B(e,t){return t?parseInt(e*X):parseInt(e*Y)}function O(e,t){return t?parseInt(e/X):parseInt(e/Y)}function S(e){e instanceof Array&&!(e.length<=0)&&e.forEach(function(e){e.myAction&&e.myAction(),S(e.children)})}var C=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.makeCanvas=r,i.render=o,i.renderWithInterpolation=h,i.addStatePlayer=c,i.capturePreviousPositions=l,i.rectangle=u,i.circle=g,i.line=f,i.text=p,i.group=d,i.sprite=m,i.spritE=v,i.newMyButton=y,i.frame=k,i.frames=b,i.button=x,i.bigmap=w,i.remove=_,i.calcPx=B,i.calcYuxiangPx=O,i.doMyAction=S;var E=i.draggableSprites=[],P=i.buttons=[],M=i.DisplayObject=function(){function e(){a(this,e),this.x=0,this.y=0,this._x=0,this._y=0,this._width=0,this._height=0,this.rotation=0,this.alpha=1,this.visible=!0,this.scaleX=1,this.scaleY=1,this._anchorX=.5,this._anchorY=.5,this._offsetX=this.width*this._anchorX,this._offsetY=this.height*this._anchorY,this.vx=0,this.vy=0,this._layer=0,this.children=[],this.parent=void 0,this.shadow=!1,this.shadowColor="rgba(100, 100, 100, 0.5)",this.shadowOffsetX=2,this.shadowOffsetY=2,this.shadowBlur=3,this.blendMode=void 0,this.frames=[],this.loop=!0,this._currentFrame=0,this.playing=!1,this._draggable=void 0,this._circular=!1,this._interactive=!1,this.previousX=0,this.previousY=0,this.init()}return C(e,[{key:"setAnchorPoint",value:function(e,t){this.anchorX=e,this.anchorY=t,this._offsetX=this._width*this.anchorX,this._offsetY=this._height*this.anchorY}},{key:"getAnchorPoint",value:function(){return{x:this.anchorX,y:this.anchorY}}},{key:"addChild",value:function(e){e.parent&&e.parent.removeChild(e),e.parent=this,this.children.push(e),this.children.sort(function(e,t){return e.layer-t.layer})}},{key:"removeChild",value:function(e){if(e.parent===this){var t=this.children.indexOf(e);t>-1&&this.children.splice(t,1),e.parent=null}}},{key:"removeTrue",value:function(){for(var e=this,t=arguments.length,i=Array(t),s=0;t>s;s++)i[s]=arguments[s];i.forEach(function(t){t&&(t instanceof Array?t.forEach(function(t){e.removeTrue(t)}):(t.children.length>0&&t.removeTrue(t.children),t.interactive=!1,e.removeChild(t)))})}},{key:"removeAll",value:function(){this.children.forEach(function(e){e.interactive=!1}),this.children=[]}},{key:"setPosition",value:function(e,t){this.x=e,this.y=t}},{key:"putCenter",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],s=this;e.x=s.x+s.halfWidth-e.halfWidth+e._offsetX-s._offsetX+t,e.y=s.y+s.halfHeight-e.halfHeight+e._offsetY-s._offsetY+i,console.log("b.x: "+e.x+" | b.y: "+e.y)}},{key:"putTop",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],s=this;e.x=s.x+s.halfWidth-e.halfWidth+e._offsetX-s._offsetX+t,e.y=s.y-e.height+e._offsetY-s._offsetY+i}},{key:"putRight",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],s=this;e.x=s.x+s.width+e._offsetX-s._offsetX+t,e.y=s.y+s.halfHeight-e.halfHeight+e._offsetY-s._offsetY+i}},{key:"putBottom",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],s=this;e.x=s.x+s.halfWidth-e.halfWidth+e._offsetX-s._offsetX+t,e.y=s.y+s.height+e._offsetY-s._offsetY+i}},{key:"putLeft",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?0:arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2],s=this;e.x=s.x-e.width+e._offsetX-s._offsetX+t,e.y=s.y+s.halfHeight-e.halfHeight+e._offsetY-s._offsetY+i}},{key:"swapChildren",value:function(e,t){var i=this.children.indexOf(e),s=this.children.indexOf(t);if(-1===i||-1===s)throw new Error("Both objects must be a child of caller ["+this+"]");this.children[i]=t,this.children[s]=e}},{key:"add",value:function(){for(var e=this,t=arguments.length,i=Array(t),s=0;t>s;s++)i[s]=arguments[s];i.forEach(function(t){e.addChild(t)})}},{key:"remove",value:function(){for(var e=this,t=arguments.length,i=Array(t),s=0;t>s;s++)i[s]=arguments[s];i.forEach(function(t){e.removeChild(t)})}},{key:"render",value:function(e){e.translate(this._offsetX,this._offsetY)}},{key:"myAction",value:function(){}},{key:"init",value:function(){}},{key:"offsetX",get:function(){return this._offsetX}},{key:"offsetY",get:function(){return this._offsetY}},{key:"width",get:function(){return this._width},set:function(e){this._width=e,this._offsetX=this._width*this._anchorX}},{key:"height",get:function(){return this._height},set:function(e){this._height=e,this._offsetY=this._height*this._anchorY}},{key:"anchorX",get:function(){return this._anchorX},set:function(e){this._anchorX=e,this._offsetX=this._width*this._anchorX}},{key:"anchorY",get:function(){return this._anchorY},set:function(e){this._anchorY=e,this._offsetY=this._height*this._anchorY}},{key:"gx",get:function(){return this.parent?this.x+this.parent.gx-this.parent._offsetX:this.x}},{key:"gy",get:function(){return this.parent?this.y+this.parent.gy-this.parent._offsetY:this.y}},{key:"layer",get:function(){return this._layer},set:function(e){this._layer=e,this.parent&&this.parent.children.sort(function(e,t){return e.layer-t.layer})}},{key:"halfWidth",get:function(){return this._width>>1}},{key:"halfHeight",get:function(){return this._height>>1}},{key:"centerX",get:function(){return this.x-this._offsetX+this.halfWidth}},{key:"centerY",get:function(){return this.y-this._offsetY+this.halfHeight}},{key:"position",get:function(){return{x:this.x,y:this.y}}},{key:"localBounds",get:function(){return{x:0,y:0,width:this._width,height:this._height}}},{key:"globalBounds",get:function(){return{x:this.gx,y:this.gy,width:this.gx+this._width,height:this.gy+this._height}}},{key:"isEmpty",get:function(){return 0===this.children.length?!0:!1}},{key:"currentFrame",get:function(){return this._currentFrame}},{key:"circular",get:function(){return this._circular},set:function(e){e===!0&&this._circular===!1&&(Object.defineProperties(this,{diameter:{get:function(){return this.width},set:function(e){this.width=e,this.height=e},enumerable:!0,configurable:!0},radius:{get:function(){return this.halfWidth},set:function(e){this.width=1>e,this.height=1>e},enumerable:!0,configurable:!0}}),this._circular=!0),e===!1&&this._circular===!0&&(delete this.diameter,delete this.radius,this._circular=!1)}},{key:"draggable",get:function(){return this._draggable},set:function(e){if(e===!0&&(E.push(this),this._draggable=!0),e===!1){var t=E.indexOf(this);t>-1&&E.splice(t,1)}}},{key:"interactive",get:function(){return this._interactive},set:function(e){if(e===!0){j(this);var t=P.indexOf(this);0>t&&(P.push(this),P.sort(function(e,t){return-(e.layer-t.layer)})),this._interactive=!0}else if(e===!1){var t=P.indexOf(this);t>-1&&P.splice(t,1),this._interactive=!1}}}]),e}(),A=i.stage=new M;A.setAnchorPoint(0,0);var T=(i.canvasscale=void 0,i.canvas_display=void 0),Y=i.bili_w=void 0,X=i.bili_h=void 0,I=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?32:arguments[0],i=arguments.length<=1||void 0===arguments[1]?32:arguments[1],n=arguments.length<=2||void 0===arguments[2]?"gray":arguments[2],r=arguments.length<=3||void 0===arguments[3]?"none":arguments[3],o=arguments.length<=4||void 0===arguments[4]?0:arguments[4],h=arguments.length<=5||void 0===arguments[5]?0:arguments[5],c=arguments.length<=6||void 0===arguments[6]?0:arguments[6];a(this,t);var l=s(this,Object.getPrototypeOf(t).call(this));return Object.assign(l,{width:e,height:i,fillStyle:n,strokeStyle:r,lineWidth:o,x:h,y:c}),l.mask=!1,l}return n(t,e),C(t,[{key:"render",value:function(e){e.strokeStyle=this.strokeStyle,e.lineWidth=this.lineWidth?this.lineWidth:1e-6,e.fillStyle=this.fillStyle,e.beginPath(),e.rect(-this._offsetX,-this._offsetY,this.width,this.height),"none"!==this.strokeStyle&&e.stroke(),"none"!==this.fillStyle&&e.fill(),this.mask&&this.mask===!0&&e.clip()}}]),t}(M),D=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?32:arguments[0],i=arguments.length<=1||void 0===arguments[1]?"gray":arguments[1],n=arguments.length<=2||void 0===arguments[2]?"none":arguments[2],r=arguments.length<=3||void 0===arguments[3]?0:arguments[3],o=arguments.length<=4||void 0===arguments[4]?0:arguments[4],h=arguments.length<=5||void 0===arguments[5]?0:arguments[5];a(this,t);var c=s(this,Object.getPrototypeOf(t).call(this));return c.circular=!0,Object.assign(c,{diameter:e,fillStyle:i,strokeStyle:n,lineWidth:r,x:o,y:h}),c.mask=!1,c}return n(t,e),C(t,[{key:"render",value:function(e){e.strokeStyle=this.strokeStyle,e.lineWidth=this.lineWidth?this.lineWidth:1e-6,e.fillStyle=this.fillStyle,e.beginPath(),e.arc(this.radius+-this.diameter*this._anchorX,this.radius+-this.diameter*this._anchorY,this.radius,0,2*Math.PI,!1),"none"!==this.strokeStyle&&e.stroke(),"none"!==this.fillStyle&&e.fill(),this.mask&&this.mask===!0&&e.clip()}}]),t}(M),H=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"none":arguments[0],i=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=arguments.length<=3||void 0===arguments[3]?0:arguments[3],o=arguments.length<=4||void 0===arguments[4]?32:arguments[4],h=arguments.length<=5||void 0===arguments[5]?32:arguments[5];a(this,t);var c=s(this,Object.getPrototypeOf(t).call(this));return Object.assign(c,{strokeStyle:e,lineWidth:i,ax:n,ay:r,bx:o,by:h}),c.lineJoin="round",c}return n(t,e),C(t,[{key:"render",value:function(e){e.strokeStyle=this.strokeStyle,e.lineWidth=this.lineWidth?this.lineWidth:1e-6,e.lineJion=this.lineJoin,e.beginPath(),e.moveTo(this.ax,this.ay),e.lineTo(this.bx,this.by),"none"!==this.strokeStyle&&e.stroke()}}]),t}(M),q=i.Text=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Hello!":arguments[0],i=arguments.length<=1||void 0===arguments[1]?"12px sans-serif":arguments[1],n=arguments.length<=2||void 0===arguments[2]?"red":arguments[2],r=arguments.length<=3||void 0===arguments[3]?0:arguments[3],o=arguments.length<=4||void 0===arguments[4]?0:arguments[4],h=arguments.length<=5||void 0===arguments[5]?0:arguments[5];a(this,t);var c=s(this,Object.getPrototypeOf(t).call(this));return c.textBaseline="top",c.align="left",c.strokeText="none",Object.assign(c,{content:e,font:i,fillStyle:n,x:r,y:o}),c.layer=h,c}return n(t,e),C(t,[{key:"render",value:function(e){e.font=this.font,e.strokeStyle=this.strokeStyle,e.lineWidth=this.lineWidth,e.fillStyle=this.fillStyle,0===this.width&&(this.width=e.measureText(this.content).width),0===this.height&&(this.height=e.measureText("M").width),e.translate(-this._offsetX,-this._offsetY),e.textBaseline=this.textBaseline,e.textAlign=this.align,e.fillText(this.content,0,0),"none"!==this.strokeText&&e.strokeText()}}]),t}(M),F=function(e){function t(){a(this,t);for(var e=s(this,Object.getPrototypeOf(t).call(this)),i=arguments.length,n=Array(i),r=0;i>r;r++)n[r]=arguments[r];return n.forEach(function(t){e.addChild(t)}),e}return n(t,e),C(t,[{key:"addChild",value:function(e){e.parent&&e.parent.removeChild(e),e.parent=this,this.children.push(e),this.calculateSize()}},{key:"removeChild",value:function(e){if(e.parent===this){var t=this.children.indexOf(e);t>-1&&this.children.splice(t,1),e.parent=null,this.calculateSize()}}},{key:"calculateSize",value:function(){var e=this;this.children.length>0&&(this._newWidth=0,this._newHeight=0,this.children.forEach(function(t){t.x+t.width>e._newWidth&&(e._newWidth=t.x+t.width),t.y+t.height>e._newHeight&&(e._newHeight=t.y+t.height)}),this.width=this._newWidth,this.height=this._newHeight)}}]),t}(M),W=i.Sprite=function(e){function t(e){var i=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=arguments.length<=3||void 0===arguments[3]?null:arguments[3];a(this,t);var o=s(this,Object.getPrototypeOf(t).call(this));if(Object.assign(o,{x:i,y:n}),Object.assign(o,r),e instanceof Image)o.createFromImage(e);else if(e.frame)o.createFromAtlas(e);else if(e.image&&!e.data)o.createFromTileset(e);else if(e.image&&e.data)o.createFromTilesetFrames(e);else{if(!(e instanceof Array))throw new Error("The image source "+e+" is not recongnized");if(e[0]&&e[0].source)o.createFromAtlasFrames(e);else{if(!(e[0]instanceof Image))throw new Error("The image source in "+e+" are not recongnized");o.createFromImages(e)}}return o}return n(t,e),C(t,[{key:"createFromImage",value:function(e){if(!(e instanceof Image))throw new Error(e+" is not an image object");this.source=e,this.sourceX=0,this.sourceY=0,this.width=e.width,this.height=e.height,this.sourceWidth=e.width,this.sourceHeight=e.height}},{key:"createFromAtlas",value:function(e){this.source=e.source,this.sourceX=e.frame.x,this.sourceY=e.frame.y,this.width=e.frame.w,this.height=e.frame.h,this.sourceWidth=e.frame.w,this.sourceHeight=e.frame.h}},{key:"createFromTileset",value:function(e){if(!(e.image instanceof Image))throw new Error(e.image+" is not an image object");this.source=e.image,this.sourceX=e.x,this.sourceY=e.y,this.width=e.width,this.height=e.height,this.sourceWidth=e.width,this.sourceHeight=e.height}},{key:"createFromTilesetFrames",value:function(e){if(!(e.image instanceof Image))throw new Error(e.image+" is not an image object");this.source=e.image,this.frames=e.data,this.sourceX=this.frames[0][0],this.sourceY=this.frames[0][1],this.width=e.width,this.height=e.height,this.sourceWidth=e.width,this.sourceHeight=e.height}},{key:"createFromAtlasFrames",value:function(e){this.frames=e,this.source=e[0].source,this.sourceX=e[0].frame.x,this.sourceY=e[0].frame.y,this.width=e[0].frame.w,this.height=e[0].frame.h,this.sourceWidth=e[0].frame.w,this.sourceHeight=e[0].frame.h}},{key:"createFromImages",value:function(e){this.frames=e,this.source=e[0],this.sourceX=0,this.sourceY=0,this.width=e[0].width,this.height=e[0].height,this.sourceWidth=e[0].width,this.sourceHeight=e[0].height}},{key:"gotoAndStop",value:function(e){if(!(this.frames.length>0&&e<this.frames.length))throw new Error("Frame number "+e+" does not exist");this.frames[0]instanceof Array?(this.sourceX=this.frames[e][0],this.sourceY=this.frames[e][1]):this.frames[e].frame?(this.sourceX=this.frames[e].frame.x,this.sourceY=this.frames[e].frame.y,this.sourceWidth=this.frames[e].frame.w,this.sourceHeight=this.frames[e].frame.h,this.width=this.frames[e].frame.w,this.height=this.frames[e].frame.h):(this.source=this.frames[e],this.sourceX=0,this.sourceY=0,this.sourceWidth=this.source.width,this.sourceHeight=this.source.height,this.width=this.source.width,this.height=this.source.height),this._currentFrame=e}},{key:"render",value:function(e){var t=this.parent;if(t&&t!=A&&!t.showoutpart){if(this.x<=-this._offsetX||this.x>=t._width+this._offsetX)return;if(this.y<=-this._offsetY||this.y>=t._height+this._offsetY)return;var i=this.sourceWidth/this._width,s=this.sourceHeight/this._height,n=void 0,a=void 0,r=void 0,o=void 0,h=void 0,c=void 0,l=void 0,u=void 0,g=void 0,f=void 0;if(l=this.x>this._offsetX?-this._offsetX:-this.x,u=this.y>this._offsetY?-this._offsetY:-this.y,n=this._offsetX-this.x,0>=n&&(n=0),a=this._offsetY-this.y,0>=a&&(a=0),r=this._offsetX+this.x,g=r<=t._width?this._width-n:this._offsetX-this.x+t._width,o=this._offsetY+this.y,f=o<=t._height?this._height-a:this._offsetY-this.y+t._height,n=parseInt(n*i),a=parseInt(a*s),h=parseInt(g*i),c=parseInt(f*s),e.drawImage(this.source,n,a,h,c,l,u,g,f),this.interactive){var p=void 0,d=void 0;p=this.x<this._width?-this.x:l,d=this.y<this._height?-this.y:u,this.eventx=p,this.eventy=d,this.eventw=g,this.eventh=f}}else e.drawImage(this.source,this.sourceX,this.sourceY,this.sourceWidth,this.sourceHeight,-this._offsetX,-this._offsetY,this._width,this._height)}}]),t}(M),z=function(e){function t(e){var i=arguments.length<=1||void 0===arguments[1]?0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?0:arguments[2];a(this,t);var r=s(this,Object.getPrototypeOf(t).call(this,e,i,n));return r.interactive=!0,r}return n(t,e),t}(W),R=function(e){function t(e,i,n,r,o,h,c,l){a(this,t);var u=s(this,Object.getPrototypeOf(t).call(this,e,i,n));return u.width=r,u.height=o,u.layer=h||0,u.fixedW=c||u.sourceWidth,u.fixedH=l||u.sourceHeight,u}return n(t,e),C(t,[{key:"render",value:function(e){e.drawImage(this.source,this.sourceX,this.sourceY,this.fixedW,this.fixedH,-this._offsetX,-this._offsetY,this._width,this._height)}}]),t}(W)},{}],18:[function(e,t,i){"use strict";function s(e){var t=arguments.length<=1||void 0===arguments[1]?1:arguments[1],i={element:e,scale:t,_x:0,_y:0,get x(){return this._x/this.scale},get y(){return this._y/this.scale},get centerX(){return this.x},get centerY(){return this.y},get position(){return{x:this.x,y:this.y}},isDown:!1,isUp:!0,tapped:!1,prepDown:0,tappedDelay:300,downTime:0,elapsedTime:0,press:void 0,release:void 0,tap:void 0,dragSprite:null,dragOffsetX:0,dragOffsetY:0,moveHandler:function(e){var t=a(e);this._x=t.x,this._y=t.y,e.preventDefault()},touchMoveHandler:function(e){var t=a(e.targetTouches[0]);this._x=t.x,this._y=t.y,e.preventDefault()},downHandler:function(e){this.isDown=!0,this.isUp=!1,this.tapped=!1,this.downTime=Date.now(),this.press&&this.press(),e.preventDefault()},touchStartHandler:function(e){var t=a(e.targetTouches[0]);this._x=t.x,this._y=t.y,this.isDown=!0,this.isUp=!1,this.tapped=!1,this.downTime=Date.now(),this.press&&this.press(),e.preventDefault()},upHandler:function(e){r.call(this,e)},touchEndHandler:function(e){r.call(this,e)},hitTestSprite:function(e){var t=!1,i=e._offsetX,s=e._offsetY;if(e.circular){var n=void 0,a=void 0;e.eventx||(n=this.x-(e.gx+e.radius-i),a=this.y-(e.gy+e.radius-s));var r=Math.sqrt(n*n+a*a);t=r<e.radius}else{var o=void 0,h=void 0,c=void 0,l=void 0;void 0!==e.eventx?(o=e.gx+e.eventx,h=o+e.eventw,c=e.gy+e.eventy,l=c+e.eventh):(o=e.gx-i,h=e.gx+e.width-i,c=e.gy-s,l=e.gy+e.height-s),t=this.x>o&&this.x<h&&this.y>c&&this.y<l}return t},updateDragAndDrop:function(e){var t=this;if(this.isDown)if(null===this.dragSprite)for(var i=e.length-1;i>-1;--i){var s=e[i];if(this.hitTestSprite(s)&&s.draggable){this.dragOffsetX=this.x-s.gx,this.dragOffsetY=this.y-s.gy,this.dragSprite=s;var n=s.parent.children;n.splice(n.indexOf(s),1),n.push(s),e.splice(e.indexOf(s),1),e.push(s);break}}else this.dragSprite.x=this.x-this.dragOffsetX,this.dragSprite.y=this.y-this.dragOffsetY;this.isUp&&(this.dragSprite=null),e.some(function(e){return t.hitTestSprite(e)&&e.draggable?(t.element.style.cursor="pointer",!0):(t.element.style.cursor="auto",!1)})}};return e.addEventListener("mousemove",i.moveHandler.bind(i)),e.addEventListener("mousedown",i.downHandler.bind(i)),window.addEventListener("mouseup",i.upHandler.bind(i)),e.addEventListener("touchmove",i.touchMoveHandler.bind(i)),e.addEventListener("touchstart",i.touchStartHandler.bind(i)),window.addEventListener("touchend",i.touchEndHandler.bind(i)),e.style.touchActino="none",i}function n(e){var t={};return t.code=e,t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=function(e){e.keyCode===t.code&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1),e.preventDefault()},t.upHandler=function(e){e.keyCode===t.code&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0),e.preventDefault()},window.addEventListener("keydown",t.downHandler.bind(t)),window.addEventListener("keyup",t.upHandler.bind(t)),t}Object.defineProperty(i,"__esModule",{value:!0}),i.makePointer=s,i.keyboard=n;var a=function(e){var t=e.target,i={x:(e.pageX||e.clientX+document.body.scrollLeft)-t.offsetLeft,y:(e.pageY||e.clientY+document.body.scrollTop)-t.offsetTop};return i},r=function(e){this.elapsedTime=Math.abs(this.downTime-Date.now()),this.elapsedTime<=this.tappedDelay&&this.tapped===!1&&(this.tapped=!0,this.tap&&this.tap()),this.isUp=!0,this.prepDown=1,this.isDown=!1,this.release&&this.release(),e.preventDefault()}},{}],19:[function(e,t,i){"use strict";function s(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}function n(e,t,i,s,n){var a=e*e,r=a*e;return t+(3*-t+e*(3*t-t*e))*e+(3*i+e*(-6*i+3*i*e))*e+(3*s-3*s*e)*a+n*r}function a(e,t,i,s,n){var a=arguments.length<=5||void 0===arguments[5]?["smoothstep"]:arguments[5],r=arguments.length<=6||void 0===arguments[6]?!1:arguments[6],o=arguments.length<=7||void 0===arguments[7]?0:arguments[7],h={};return"spline"===a[0]&&(h.startMagnitude=a[1],h.endMagnitude=a[2]),h.start=function(e,t){h.startValue=JSON.parse(JSON.stringify(e)),h.endValue=JSON.parse(JSON.stringify(t)),h.playing=!0,h.totalFrames=n,h.frameCounter=0,x.push(h)},h.start(i,s),h.update=function(){var i=void 0;if(h.playing)if(h.frameCounter<h.totalFrames){var s=h.frameCounter/h.totalFrames;i="spline"!==a[0]?w[a](s):w.spline(s,h.startMagnitude,0,1,h.endMagnitude),e[t]=h.endValue*i+h.startValue*(1-i),h.frameCounter+=1}else h.end()},h.end=function(){h.playing=!1,h.onComplete&&h.onComplete(),x.splice(x.indexOf(h),1),r&&b(o).then(function(){h.start(h.endValue,h.startValue)})},h.play=function(){return h.playing=!0},h.pause=function(){return h.playing=!1},h}function r(e){var t=arguments.length<=1||void 0===arguments[1]?60:arguments[1];return a(e,"alpha",e.alpha,0,t,["sine"])}function o(e){var t=arguments.length<=1||void 0===arguments[1]?60:arguments[1];return a(e,"alpha",e.alpha,1,t,["sine"])}function h(e){var t=arguments.length<=1||void 0===arguments[1]?60:arguments[1],i=arguments.length<=2||void 0===arguments[2]?0:arguments[2];return a(e,"alpha",e.alpha,i,t,["smoothstep"],!0)}function c(e){var t={};t.tweens=[],e.forEach(function(e){var i=a.apply(void 0,s(e));t.tweens.push(i)});var i=0;return t.completed=function(){i+=1,i===t.tweens.length&&(t.onComplete&&t.onComplete(),i=0)},t.tweens.forEach(function(e){e.onComplete=function(){return t.completed()}}),t.pause=function(){t.tweens.forEach(function(e){e.playing=!1})},t.play=function(){t.tweens.forEach(function(e){e.playing=!0})},t}function l(e,t,i){var s=arguments.length<=3||void 0===arguments[3]?60:arguments[3],n=arguments.length<=4||void 0===arguments[4]?["smoothstep"]:arguments[4],a=arguments.length<=5||void 0===arguments[5]?!1:arguments[5],r=arguments.length<=6||void 0===arguments[6]?0:arguments[6];return c([[e,"x",e.x,t,s,n,a,r],[e,"y",e.y,i,s,n,a,r]])}function u(e,t,i,s){function n(){return a++,a<t.length-1?l(e,t[a],i[a],s).onComplete=n:l(e,t[a],i[a],s)}if(!(t instanceof Array))return l(e,t,i,s);var a=-1;return n()}function g(e,t,i){var s=arguments.length<=3||void 0===arguments[3]?60:arguments[3],n=arguments.length<=4||void 0===arguments[4]?!0:arguments[4],a=arguments.length<=5||void 0===arguments[5]?0:arguments[5];return c([[e,"scaleX",e.scaleX,t,s,["smoothstepSquared"],n,a],[e,"scaleY",e.scaleY,i,s,["smoothstepSquared"],n,a]])}function f(e,t,i){var s=arguments.length<=3||void 0===arguments[3]?60:arguments[3];return c([[e,"scaleX",e.scaleX,t,s,["smoothstep"],!1],[e,"scaleY",e.scaleY,i,s,["smoothstep"],!1]])}function p(e){var t=arguments.length<=1||void 0===arguments[1]?1.3:arguments[1],i=arguments.length<=2||void 0===arguments[2]?10:arguments[2],s=arguments.length<=3||void 0===arguments[3]?20:arguments[3],n=arguments.length<=4||void 0===arguments[4]?10:arguments[4],a=arguments.length<=5||void 0===arguments[5]?!0:arguments[5],r=arguments.length<=6||void 0===arguments[6]?0:arguments[6];return c([[e,"scaleX",e.scaleX,t,n,["spline",i,s],a,r],[e,"scaleY",e.scaleY,t,n,["spline",i,s],a,r]])}function d(e){var t=arguments.length<=1||void 0===arguments[1]?1.2:arguments[1],i=arguments.length<=2||void 0===arguments[2]?1.2:arguments[2],s=arguments.length<=3||void 0===arguments[3]?10:arguments[3],n=arguments.length<=4||void 0===arguments[4]?10:arguments[4],a=arguments.length<=5||void 0===arguments[5]?10:arguments[5],r=arguments.length<=6||void 0===arguments[6]?-10:arguments[6],o=arguments.length<=7||void 0===arguments[7]?-10:arguments[7],h=arguments.length<=8||void 0===arguments[8]?.98:arguments[8],l=arguments.length<=9||void 0===arguments[9]?!0:arguments[9],u=arguments.length<=10||void 0===arguments[10]?0:arguments[10],g=c([[e,"scaleX",e.scaleX,t,s,["spline",n,a],l,u],[e,"scaleY",e.scaleY,i,s,["spline",r,o],l,u]]);return g.tweens.forEach(function(e){e.onComplete=function(){e.endValue>1&&(e.endValue*=h,e.endValue<=1&&(e.endValue=1,m(e)))}}),g}function m(e){e.tweens?(e.pause(),e.tweens.forEach(function(e){x.splice(x.indexOf(e),1)})):(e.pause(),x.splice(x.indexOf(e),1))}function v(e,t,i){var s=arguments.length<=3||void 0===arguments[3]?["smoothstep"]:arguments[3],a=arguments.length<=4||void 0===arguments[4]?!1:arguments[4],r=arguments.length<=5||void 0===arguments[5]?0:arguments[5],o={};return"spline"===s[0]&&(o.startMagnitude=s[1],o.endMagnitude=s[2]),o.start=function(e){o.playing=!0,o.totalFrames=i,o.frameCounter=0,o.pointsArray=JSON.parse(JSON.stringify(e)),x.push(o)},o.start(t),o.update=function(){var t=void 0,i=void 0,a=o.pointsArray;o.playing&&(o.frameCounter<o.totalFrames?(t=o.frameCounter/o.totalFrames,i="spline"!==s[0]?w[s](t):w.spline(t,o.startMagnitude,0,1,o.endMagnitude),e.x=n(i,a[0][0],a[1][0],a[2][0],a[3][0]),e.y=n(i,a[0][1],a[1][1],a[2][1],a[3][1]),o.frameCounter+=1):o.end())},o.end=function(){o.playing=!1,o.onComplete&&o.onComplete(),x.splice(x.indexOf(o),1),a&&b(r).then(function(){o.pointsArray=o.pointsArray.reverse(),o.start(o.pointsArray)})},o.pause=function(){o.playing=!1},o.play=function(){o.playing=!0},o}function y(e,t){function i(t){var s=c([[e,"x",h[t][0],h[t+1][0],l,n],[e,"y",h[t][1],h[t+1][1],l,n]]);return s.onComplete=function(){t+=1,t<h.length-1?b(o).then(function(){s=i(t)}):a&&(r&&h.reverse(),b(o).then(function(){t=0,e.x=h[0][0],e.y=h[0][1],s=i(t)}))},s}var s=arguments.length<=2||void 0===arguments[2]?300:arguments[2],n=arguments.length<=3||void 0===arguments[3]?["smoothstep"]:arguments[3],a=arguments.length<=4||void 0===arguments[4]?!1:arguments[4],r=arguments.length<=5||void 0===arguments[5]?!1:arguments[5],o=arguments.length<=6||void 0===arguments[6]?0:arguments[6],h=JSON.parse(JSON.stringify(t)),l=s/h.length,u=0,g=i(u);return g}function k(e,t){function i(s){var c=v(e,t[s],h,n);return c.onComplete=function(){s+=1,s<t.length?b(o).then(function(){c=i(s)}):a&&(r&&(t.reverse(),t.forEach(function(e){return e.reverse()})),b(o).then(function(){s=0,e.x=t[0][0],e.y=t[0][1],c=i(s)}))},c}var s=arguments.length<=2||void 0===arguments[2]?300:arguments[2],n=arguments.length<=3||void 0===arguments[3]?["smoothstep"]:arguments[3],a=arguments.length<=4||void 0===arguments[4]?!1:arguments[4],r=arguments.length<=5||void 0===arguments[5]?!1:arguments[5],o=arguments.length<=6||void 0===arguments[6]?0:arguments[6],h=s/t.length,c=0,l=i(c);return l}function b(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];return new Promise(function(t,i){setTimeout(t,e)})}Object.defineProperty(i,"__esModule",{value:!0}),i.tweenProperty=a,i.fadeOut=r,i.fadeIn=o,i.pulse=h,i.slide=l,
i.slidePath=u,i.breathe=g,i.scale=f,i.strobe=p,i.wobble=d,i.removeTween=m,i.followCurve=v,i.walkPath=y,i.walkCurve=k;var x=i.tweens=[],w={linear:function(e){return e},smoothstep:function(e){return e*e*(3-2*e)},smoothstepSquared:function(e){return Math.pow(e*e*(3-2*e),2)},smoothstepCubed:function(e){return Math.pow(e*e*(3-2*e),3)},acceleration:function(e){return e*e},accelerationCubed:function(e){return Math.pow(e*e,3)},deceleration:function(e){return 1-Math.pow(1-e,2)},decelerationCubed:function(e){return 1-Math.pow(1-e,3)},sine:function(e){return Math.sin(e*Math.PI/2)},sineSquared:function(e){return Math.pow(Math.sin(e*Math.PI/2),2)},sineCubed:function(e){return Math.pow(Math.sin(e*Math.PI/2),2)},inverseSine:function(e){return 1-Math.sin((1-e)*Math.PI/2)},inverseSineSquared:function(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),2)},inverseSineCubed:function(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),3)},spline:function(e,t,i,s,n){return.5*(2*i+(-t+s)*e+(2*t-5*i+4*s-n)*e*e+(-t+3*i-3*s+n)*e*e*e)}}},{}],20:[function(e,t,i){"use strict";function s(){for(var e=this,t=arguments.length,i=Array(t),s=0;t>s;s++)i[s]=arguments[s];i.forEach(function(t){var i=e.indexOf(t);0>i&&e.push(t)})}function n(e,t){return Math.atan2(t.centerY-e.centerY,t.centerX-e.centerX)}function a(e,t){var i=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],s=arguments.length<=3||void 0===arguments[3]?void 0:arguments[3],n=t.x,a=t.y,r=t.width,o=t.height,h=!1,c=n+e._offsetX,l=a+e._offsetX,u=r-(e.width-e._offsetX),g=o-(e.height-e._offsetY);return e.x<c&&(i&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=c,h="letf"),e.y<l&&(i&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=l,h="top"),e.x>u&&(i&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=u,h="right"),e.y>g&&(i&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=g,h="bottom"),h&&s&&s(h),h}function r(e,t){var i=t.centerX-e.centerX,s=t.centerY-e.centerY;return Math.sqrt(i*i+s*s)}function o(e,t,s){var n=t.centerX-e.centerX,a=t.centerY-e.centerY;i.distance=r=Math.sqrt(n*n+a*a),r>=s&&(e.x+=n/r*s,e.y+=a/r*s)}function h(e,t,s){var n=t.centerX-e.centerX,a=t.centerY-e.centerY;i.distance=r=Math.sqrt(n*n+a*a),r>0&&(e.x+=n*s,e.y+=a*s)}function c(e,t){var i=arguments.length<=2||void 0===arguments[2]?void 0:arguments[2],s=t.x,n=t.y,a=t.width,r=t.height,o=void 0;return e.x<s-e.width&&(o="left"),e.y<n-e.height&&(o="top"),e.x>a&&(o="right"),e.y>r&&(o="bottom"),o&&i&&i(o),o}function l(e,t,i,s){e.x=t.centerX-e.parent.x+e._offsetX+i*Math.cos(s)-e.halfWidth,e.y=t.centerY-e.parent.y+e._offsetY+i*Math.sin(s)-e.halfHeight}function u(e,t,i,s,n){var a={};return a.x=e+Math.cos(n)*i,a.y=t+Math.sin(n)*s,a}function g(e,t){return Math.floor(Math.random()*(t-e+1))+e}function f(e,t){return e+Math.random()*(t-e)}function p(){for(var e=this,t=arguments.length,i=Array(t),s=0;t>s;s++)i[s]=arguments[s];i.forEach(function(t){var i=e.indexOf(t);i>=0&&e.splice(i,1)})}function d(e,t,i,s,n,a){var r=a();r.x=e.centerX+i*Math.cos(t),r.y=e.centerY+i*Math.sin(t),r.vx=Math.cos(t)*s,r.vy=Math.sin(t)*s,n.push(r)}Object.defineProperty(i,"__esModule",{value:!0}),i.addToArray=s,i.angle=n,i.contain=a,i.distance=r,i.followConstant=o,i.followEase=h,i.outsideBounds=c,i.rotateSprite=l,i.rotatePoint=u,i.randomInt=g,i.randomFloat=f,i.removeFromArray=p,i.shoot=d;i.assets={to_load:0,loaded:0,root:"./assets/",imageExtensions:["png","jpg","gif"],fontExtensions:["ttf","otf","ttc","woff"],textExtensions:["json","xml","glsl"],audioExtensions:["mp3","ogg","wav","webm"],load:function(e){var t=this;return new Promise(function(i){var s=function(){t.loaded+=1,console.log("[ "+t.loaded+" / "+t.to_load+" ]"),t.to_load==t.loaded&&(t.to_load=0,t.loaded=0,console.log("Assets finished loading"),i())};console.log("Loading assets..."),t.to_load=e.length,t.to_load<1?(console.log("no assets need to load."),i()):e.forEach(function(e){var i=e.split(".").pop();-1!==t.imageExtensions.indexOf(i)?t.loadImage(e,s):-1!==t.fontExtensions.indexOf(i)?t.loadFont(e,s):-1!==t.textExtensions.indexOf(i)?"json"===i?t.loadJson(e,s):"xml"===i?t.loadXML(e,s):t.loadText(e,s):-1!==t.audioExtensions.indexOf(i)?t.loadSound(e,s):console.log("File type not recongnized: "+e)})})},loadImage:function(e,t){var i=new Image;i.addEventListener("load",t,!1),this[e]=i,i.src=this.root+e},loadFont:function(e,t){var i=e.split("/").pop().split(".")[0],s=document.createElement("style"),n="@font-face {font-family: '"+i+"'; src: url('"+this.root+e+"');}";s.appendChild(document.createTextNode(n)),document.head.appendChild(s),t()},loadJson:function(e,t){var i=this,s=new XMLHttpRequest;s.open("GET",this.root+e,!0),s.responseType="text",s.onload=function(n){if(200===s.status){var a=JSON.parse(s.responseText);a.name=e,i[a.name]=a,a.frames?i.createTilesetFrames(a,e,t):t()}},s.send()},loadXML:function(e,t){var i=this,s=new XMLHttpRequest;s.open("GET",this.root+e,!0),s.responseType="text",s.onload=function(n){if(200===s.status){var a=new DOMParser,r=a.parseFromString(s.responseText,"text/xml");r.name=e,i[r.name]=r,t()}},s.send()},loadText:function(e,t){var i=this,s=new XMLHttpRequest;s.open("GET",this.root+e,!0),s.responseType="text",s.onload=function(n){if(200===s.status){var a=s.responseText;i[e]=a,t()}},s.send()},createTilesetFrames:function(e,t,i){var s=this,n=t.replace(/[^\/]*$/,""),a=n+e.meta.image,r=new Image,o=function(){s[a]=r,Object.keys(e.frames).forEach(function(t){s[t]=e.frames[t],s[t].source=r}),i()};r.addEventListener("load",o,!1),r.src=this.root+a},loadSound:function(e,t){var i=makeSound(this.root+e,t);i.name=e,this[i.name]=i}}},{}],21:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./max/utilities"),h=e("./max/display.js"),c=e("./t0.js"),l=function(e){function t(e){s(this,t);var i=n(this,Object.getPrototypeOf(t).call(this,o.assets["images/trans.png"])),a=e.board,r=a.mission.data;switch(a.mission.type){case"eliminate":i.sl=[];var l=50,u=void 0,g=void 0;switch(r.length){case 1:l=100,u=100,g=80;break;case 2:u=60,g=50}for(var f=0;f<r.length;f++){var p=r[f].type,d=r[f].data,m=(0,h.spritE)(o.assets["images/trans.png"],l+2*u*f,185,50,50,6);switch(p){case 0:case 1:case 2:case 3:case 4:m.createFromImage(o.assets[c.boardAssets[p]]);break;case 5:m.createFromImage(o.assets["images/fk_ice1.png"]);break;case 6:m.createFromImage(o.assets["images/fk_nikuai.png"]);break;case 7:m.createFromImage(o.assets["images/fk13.png"])}m.width=(0,h.calcPx)(50),m.height=(0,h.calcPx)(50,1),i.sl[f]=(0,h.text)(d,"40px 微软雅黑","white",l+g+2*u*f,180,6)}break;case"cellect":(0,h.spritE)(o.assets[c.boardAssets[6]],100,180,64,64,6);i.sl=(0,h.text)(r,"50px 微软雅黑","white",180,170,6);break;case"score":(0,h.text)("score","30px 微软雅黑","white",135,150,10);i.sl=(0,h.text)(r,"40px 微软雅黑","white",190,185,10),i.sl.align="center";break;case"boss":(0,h.text)("BOSS HP","35px 微软雅黑","white",105,185,6);i.sl=(0,h.text)(r.hp,"35px 微软雅黑","white",220,185,6);break;case"escape":(0,h.text)("ESCAPE","40px 微软雅黑","white",136,180,6),(0,h.spritE)(o.assets["images/fk_door.png"],150,185,30,40,7);break;case"rescue":(0,h.spritE)(o.assets["images/fk_cunmin.png"],100,180,64,64,6);i.sl=(0,h.text)(r.length,"50px 微软雅黑","white",180,170,6)}return i.board=a,i.view=e,i}return a(t,e),r(t,[{key:"myAction",value:function(){var e=this.board,t=this.view,i=e.mission,s=i.data;switch(i.type){case"eliminate":for(var n=0;n<this.sl.length;n++){var a=s[n].type,r=s[n].data-t.eliminate[a];this.sl[n].content=0>r?0:r}break;case"cellect":this.sl.content=s-e.goldbeans;break;case"score":var o=s-t.score;this.sl.content=0>o?0:o;break;case"boss":this.sl.content=t.bosshp;break;case"rescue":this.sl.content=s.length-e.rescuecunminshu}}}]),t}(h.Sprite);i["default"]=l},{"./max/display.js":17,"./max/utilities":20,"./t0.js":32}],22:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.OtherMenu=void 0;var a=e("./max/display.js"),r=e("./max/utilities.js"),o=e("./max/tween.js"),h=e("./knapsack.js");i.OtherMenu=function(){function e(t){function i(){for(var e=arguments.length,t=Array(e),i=0;e>i;i++)t[i]=arguments[i];t.forEach(function(e){e.scaleX=.1,e.scaleY=.1,e.interactive=!1})}var n=this;s(this,e),this.index=t,this.knapsack=(0,a.newMyButton)(r.assets["images/knapsack.png"],440,800,80,80,5),this.knapsack.release=function(){t.content.removeAll(),n.hide(),t.content=new h.Knapsack},i(this.knapsack),this.show()}return n(e,[{key:"show",value:function(){var e=this;this.showing=!0,this.knapsack.alpha=1,(0,o.scale)(this.knapsack,1,1,20).onComplete=function(){e.knapsack.interactive=!0}}},{key:"hide",value:function(){var e=this;this.showing=!1,(0,o.scale)(this.knapsack,.1,.1,20).onComplete=function(){e.knapsack.alpha=0,e.knapsack.interactive=!1}}}]),e}()},{"./knapsack.js":14,"./max/display.js":17,"./max/tween.js":19,"./max/utilities.js":20}],23:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){var i=new u(e,t);return c.stage.add(i),i}function o(e){switch(e){case 108:return.26;case 105:case 106:return.27;case 73:return.3;case 102:return.36;case 116:return.37;case 74:case 114:return.39;case 115:return.46;case 122:return.48;case 99:return.5;case 120:return.51;case 76:return.52;case 118:case 121:return.53;case 70:case 107:return.54;case 97:return.55;case 69:case 101:return.56;case 83:case 84:return.57;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return.58;case 80:case 89:case 90:case 104:case 110:case 117:return.61;case 66:case 100:case 103:case 111:case 113:return.63;case 98:return.64;case 75:case 88:case 112:return.65;case 67:case 82:return.67;case 86:return.69;case 65:return.7;case 71:case 85:return.74;case 68:return.76;case 72:return.78;case 119:return.8;case 78:case 79:case 81:return.81;case 109:return.93;case 77:return.98;case 87:return 1}}var h=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.newParagraph=r,i.widthParcentOfCharCode=o;var c=e("./max/display.js"),l=e("./t0.js"),u=function(e){function t(){var e=arguments.length<=0||void 0===arguments[0]?"Hello!":arguments[0],i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];s(this,t);var a=n(this,Object.getPrototypeOf(t).call(this));return a.width=(0,c.calcPx)(300),a.textBaseline="top",a.strokeText="none",a.align="left",i&&(i.width&&(i.width=(0,c.calcPx)(i.width)),i.x&&(i.x=(0,c.calcPx)(i.x)),i.y&&(i.y=(0,c.calcPx)(i.y,1)),i.size?a._size=(0,c.calcPx)(i.size):a._size=8),Object.assign(a,i),a.font=a._size+"px 微软雅黑",i.color?a.fillStyle=i.color:a.fillStyle="black",i.layer&&(a.layer=i.layer),a.ctx=l.canvas.ctx,a.setText(e),a}return a(t,e),h(t,[{key:"setText",value:function(e){this.texts=[],this.maxlength=0;for(var t=0,i=void 0,s=0,n=void 0,a=0;a<e.length;a++)if(i=e.charCodeAt(a),i>=0&&128>i?(n=o(i),s+=n?n*this._size:.31*this._size):s+=this._size,s>this.width||a==e.length-1){if(a==e.length-1&&s<=this.width&&a++,this.texts.push(e.substr(t,a-t)),this.maxlength++,a==e.length)break;s=0,t=a,a--}}},{key:"render",value:function(e){e.font=this.font,e.strokeStyle=this.strokeStyle,e.lineWidth=this.lineWidth,e.fillStyle=this.fillStyle,e.textAlign=this.align,this.height=e.measureText("M").width*this.maxlength,e.translate(-this._offsetX,-this._offsetY),e.textBaseline=this.textBaseline;for(var t=0;t<this.texts.length;t++)e.fillText(this.texts[t],0,t*this._size),"none"!==this.strokeText&&e.strokeText()}},{key:"removeAll",value:function(){this.texts=[]}}]),t}(c.DisplayObject)},{"./max/display.js":17,"./t0.js":32}],24:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(){var e=new u;return h.stage.add(e),e}var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.newPause=r;var h=e("./max/display.js"),c=e("./t0.js"),l=e("./max/utilities.js"),u=function(e){function t(){s(this,t);var e=n(this,Object.getPrototypeOf(t).call(this));return e.jixu=(0,h.newMyButton)(l.assets["images/jixuyouxi.png"],270,300,100,50,20),e.jixu.release=function(){(0,c.gamePause)()},e.jieshu=(0,h.newMyButton)(l.assets["images/jieshuchuangguan.png"],270,400,100,50,20),e.jieshu.release=function(){(0,c.gotoIndex)()},e.hidE(),e}return a(t,e),o(t,[{key:"hidE",value:function(){this.show=!1,this.jixu.alpha=0,this.jixu.interactive=!1,this.jieshu.alpha=0,this.jieshu.interactive=!1}},{key:"showOrHide",value:function(){this.show?this.hidE():this.shoW()}},{key:"shoW",value:function(){this.show=!0,this.jixu.alpha=1,this.jixu.interactive=!0,this.jieshu.alpha=1,this.jieshu.interactive=!0}},{key:"update",value:function(e,t){this.jixu.update(e,t),this.jieshu.update(e,t)}}]),t}(h.DisplayObject)},{"./max/display.js":17,"./max/utilities.js":20,"./t0.js":32}],25:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.Raffle=void 0;var a=e("./max/utilities"),r=e("./max/display.js"),o=e("./floattext.js"),h=(e("./index.js"),e("./chooselevel.js"),e("./herocard.js"),e("./knapsack.js"),e("./t0.js"));i.Raffle=function(){function e(){function t(e){var t=[];if(e>9){for(var s=0;9>s;s++)t.push(i());t.push(i(1))}else t.push(i());for(var s=0;s<t.length;s++)(0,o.newFloatText)("获得了"+t[s]+"号道具",270,600,"white")}function i(e){var t=n(5);return t}function n(e){return parseInt(Math.random()*e)}s(this,e),this.bg=(0,r.spritE)(a.assets["images/herotujian_di.png"],270,480,520,710,10);this.bt1=(0,r.newMyButton)(a.assets["images/shop_chouqu1.png"],150,710,150,100,15),this.bt1.release=function(){t(1)},this.bt2=(0,r.newMyButton)(a.assets["images/shop_chouqu10.png"],400,710,150,100,15),this.bt2.release=function(){t(10)},this.dj=[];for(var c=0;c<h.boardAssets.length;c++){var l=(0,r.spritE)(a.assets[h.boardAssets[c]],100+n(400),700+50*c,80,80,12,{father:this.bg});l.speed=2+n(3),l.myAction=function(){this.y-=this.speed,this.y<-100&&(this.y=800,this.x=100+n(400),this.speed=2+n(3))},this.dj.push(l)}}return n(e,[{key:"removeAll",value:function(){r.stage.removeTrue(this.bg,this.bt1,this.bt2,this.dj)}}]),e}()},{"./chooselevel.js":5,"./floattext.js":7,"./herocard.js":10,"./index.js":12,"./knapsack.js":14,"./max/display.js":17,"./max/utilities":20,"./t0.js":32}],26:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.ReadyView=void 0;var n=e("./max/display.js"),a=e("./max/utilities.js"),r=e("./t0.js");i.ReadyView=function o(){s(this,o);var e=(0,n.newMyButton)(a.assets["images/background.png"],270,480,540,960);e.release=function(){(0,r.gotoIndex)()};var t=(0,n.text)("开始游戏","50px 微软雅黑","black",270,500,2);t.alphachange=0,t.myAction=function(){this.alphachange?(this.alpha+=.03,this.alpha>.9&&(this.alphachange=0)):(this.alpha-=.03,this.alpha<.1&&(this.alphachange=1))}}},{"./max/display.js":17,"./max/utilities.js":20,"./t0.js":32}],27:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./max/utilities"),h=e("./max/display.js"),c=function(e){function t(e){s(this,t);var i=n(this,Object.getPrototypeOf(t).call(this,o.assets["images/trans.png"]));return i.view=e,i.score=(0,h.text)("SCORE  "+i.view.score,"30px 微软雅黑","white",210,90,10),i.score.align="center",i}return a(t,e),r(t,[{key:"myAction",value:function(){this.score.content="SCORE  "+this.view.score}}]),t}(h.Sprite);i["default"]=c},{"./max/display.js":17,"./max/utilities":20}],28:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.Sell=i.propintroduce=i.commodityicon=i.commodityname=i.commodityprice=i.commodityid=void 0;var a=e("./commodity.js"),r=e("./max/display.js"),o=e("./max/utilities.js"),h=i.commodityid=[0,1,2,3,4,5,6,7],c=i.commodityprice=[10,100,1e3,1e4,9999,1,0,9],l=i.commodityname=["dj1","dj2","dj3","dj4","dj5","dj6","dj7","dj8"],u=i.commodityicon=["images/fk0.png","images/fk1.png","images/fk2.png","images/fk3.png","images/fk4.png","images/fk5.png","images/fk6.png","images/fk11.png"];i.propintroduce=["dj1","dj2","dj3","dj4","dj5","dj6","dj7","dj8"],i.Sell=function(){function e(){function t(e){Math.abs(e)<25||(g.moved=!0,e>0&&p>1?i(--p):0>e&&d>p&&i(++p))}function i(e){n.removeCommodityContent();var t=12*(e-1),i=h.length-t;i>12&&(i=12);for(var s=0;i>s;s++){var a=t+s;f[s].site=a;var r=h[a];f[s].id=r;var g=c[r];f[s].price=g,f[s].pricetx.content=g,f[s].name.content=l[r],f[s].createFromImage(o.assets[u[r]]),f[s].interactive=!0}if(16>i)for(var s=i;16>s;s++)f[s].source=o.assets["images/trans.png"],f[s].interactive=!1}s(this,e);var n=this,g=(0,r.newMyButton)(o.assets["images/herotujian_di.png"],270,480,520,710,10);g.press=function(){this.pressox=this.pointx,this.moved=!1},g.moveIn=function(){this.pressox=this.pointx,this.moved=!1},g.moveOut=function(){this.moved=!1},g.move=function(){t(this.pointx-this.pressox),this.pressox=this.pointx},g.release=function(){this.moved&&(this.movetime=10),this.moved=!1},g.myAction=function(){this.movetime&&this.movetime--},this.bg=g;for(var f=[],p=1,d=Math.ceil(h.length/12),m=d>1?12:h.length,v=0;m>v;v++)f[v]=new a.Commodity(h[v],90+v%3*180,250+180*parseInt(v/3),this),r.stage.add(f[v]);this.commodity=f}return n(e,[{key:"removeCommodityContent",value:function(){this.commodity.forEach(function(e){e.content&&e.content.show&&e.content.removeAll()})}},{key:"removeCommodity",value:function(){this.commodity.forEach(function(e){e.removeAll()})}},{key:"removeAll",value:function(){this.removeCommodity(),r.stage.removeTrue(this.bg)}}]),e}()},{"./commodity.js":6,"./max/display.js":17,"./max/utilities.js":20}],29:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.Shop=void 0;var a=e("./max/display.js"),r=e("./max/utilities.js"),o=(e("./commodity.js"),e("./index.js")),h=(e("./chooselevel.js"),e("./herocard.js")),c=e("./knapsack.js"),l=e("./sell.js"),u=e("./raffle.js");i.Shop=function(){function e(t,i,n){var g=this;s(this,e),t&&(o.index_g.back.alpha=1,o.index_g.back.release=function(){1==o.index_g.back.alpha&&("herocard"==t?o.index_g.content=new h.HeroCard(i):"knapsack"==t?o.index_g.content=new c.Knapsack:o.index_g.hideBackAndIndex(),g.removeAll())}),o.index_g.index.alpha=1,o.index_g.index.interactive=!0,o.index_g.bgmoveable=!1,o.index_g.title="shop",this.title=(0,a.text)("商店","50px 微软雅黑","black",300,70,15),"raffle"==n?this.content=new u.Raffle:this.content=new l.Sell,this.sellbt=(0,a.newMyButton)(r.assets["images/shop_sell.png"],150,120,80,30,15),this.sellbt.release=function(){g.content.removeAll(),g.content=new l.Sell},this.raffle=(0,a.newMyButton)(r.assets["images/shop_raffle.png"],390,120,80,30,15),this.raffle.release=function(){g.content.removeAll(),g.content=new u.Raffle},this.money=(0,a.text)("金钱：xxxxxxx","30px 微软雅黑","black",270,25,15)}return n(e,[{key:"removeAll",value:function(){this.content.removeAll(),a.stage.removeTrue(this.title,this.sellbt,this.raffle,this.money)}}]),e}()},{"./chooselevel.js":5,"./commodity.js":6,"./herocard.js":10,"./index.js":12,"./knapsack.js":14,"./max/display.js":17,"./max/utilities.js":20,"./raffle.js":25,"./sell.js":28}],30:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./max/utilities"),h=e("./max/display.js"),c=function(e){function t(e){function i(){if(e.selectable){switch(this.id){case 1:if(8==e.skillclick){if(r.sk_warrior>8)return;r.sk_warrior++}if(r.sk_warrior<1)return;break;case 2:if(8==e.skillclick){if(r.sk_priest>8)return;r.sk_priest++}if(r.sk_priest<1)return;break;case 3:if(8==e.skillclick){if(r.sk_rune_keeper>8)return;r.sk_rune_keeper++}if(r.sk_rune_keeper<1)return;break;case 4:if(8==e.skillclick){if(r.sk_robber>8)return;r.sk_robber++}if(r.sk_robber<1)return;break;case 5:if(8==e.skillclick){if(r.sk_hunter>8)return;r.sk_hunter++}if(r.sk_hunter<1)return}if(8==e.skillclick&&this.id<6)return e.skilllaunchnum--,e.skilllaunchnum<1?e.skillclick=0:r.sk_hunter>8&&r.sk_priest>8&&r.sk_robber>8&&r.sk_rune_keeper>8&&r.sk_warrior>8&&(e.skillclick=0,e.skilllaunchnum=0,d.hideTishi()),void d.updateNum();if(this.id>6){if(!r.sk_player)return;switch(r.sk_player=!1,r.energy=e.energy=0,this.id){case 7:case 8:case 9:this.level>2?e.skilllaunchnum=4:this.level>1?e.skilllaunchnum=3:e.skilllaunchnum=2;break;case 10:this.level>2?e.skilllaunchnum=3:this.level>1?e.skilllaunchnum=2:e.skilllaunchnum=1;break;case 11:this.level>2?e.skilllaunchnum=5:this.level>1?e.skilllaunchnum=4:e.skilllaunchnum=3;break;case 12:this.level>2?e.skilllaunchnum="oo":this.level>1?e.skilllaunchnum=8:e.skilllaunchnum=5}}if(e.cursor.selected=!1,e.selectBlockEffect(!1),e.skillclick==this.id)return d.hideTishi(),e.skillclick=0;2!=this.id&&12!=this.id&&(d.skilltishi.x=this.x,d.skilltishi.y=this.y,d.skilltishi.width=this.width+2,d.skilltishi.height=this.height+2),e.skillclick=this.id,this.id<6&&(e.skilllaunchnum=0),2==this.id?(e.skillclick=0,r.skillPriest()):8==this.id&&r.sk_hunter>8&&r.sk_priest>8&&r.sk_robber>8&&r.sk_rune_keeper>8&&r.sk_warrior>8?(e.skillclick=0,e.skilllaunchnum=0):12==this.id&&(e.downable=!1,e.skillclick=0,r.skillTrigger(12,e,e.boardEventsHandler.bind(e))),d.updateNum()}}s(this,t);var a=n(this,Object.getPrototypeOf(t).call(this,o.assets["images/trans.png"]));a.view=e;var r=e.board;a.board=r;var c=(0,h.spritE)(o.assets["images/fk0.png"],60,900,55,55,10);c.id=1,h.stage.add(c),c.interactive=!0,c.press=i,a.sk1=(0,h.text)("1","20px 微软雅黑","white",85,930,10);var l=(0,h.spritE)(o.assets["images/fk1.png"],115,845,55,55,10);l.id=2,h.stage.add(l),l.interactive=!0,l.press=i,a.sk2=(0,h.text)("1","20px 微软雅黑","white",142,870,10);var u=(0,h.spritE)(o.assets["images/fk2.png"],185,900,55,55,10);u.id=3,h.stage.add(u),u.interactive=!0,u.press=i,a.sk3=(0,h.text)("1","20px 微软雅黑","white",212,930,10);var g=(0,h.spritE)(o.assets["images/fk3.png"],245,845,55,55,10);g.id=4,h.stage.add(g),g.interactive=!0,g.press=i,a.sk4=(0,h.text)("1","20px 微软雅黑","white",272,871,10);var f=(0,h.spritE)(o.assets["images/fk4.png"],315,900,55,55,10);f.id=5,h.stage.add(f),f.interactive=!0,f.press=i,a.sk5=(0,h.text)("1","20px 微软雅黑","white",343,930,10);var p=(0,h.spritE)(o.assets["images/skill.png"],445,850,130,130,10);p.id=r.hero.id,p.level=r.hero.level,p.interactive=!0,p.press=i,a.zjs=(0,h.text)("","50px 微软雅黑","white",480,840,11),a.zjs.align="center",a.energy=(0,h.text)("","30px 微软雅黑","white",480,935,11),a.energy.align="center",a.heroenergy=r.hero.energy;var d=a;return a.skilltishi=(0,h.newMyButton)(o.assets["images/frame.png"],-100,0,58,58,11),a.updateNum(),a}return a(t,e),r(t,[{key:"hideTishi",value:function(){this.skilltishi.x=-200}},{key:"myAction",value:function(){this.energy.content=Math.round(this.view.energy/this.heroenergy*100)+"%"}},{key:"updateNum",value:function(e){this.sk1.content=this.board.sk_warrior,this.sk2.content=this.board.sk_priest,this.sk3.content=this.board.sk_rune_keeper,this.sk4.content=this.board.sk_robber,this.sk5.content=this.board.sk_hunter,e?this.zjs.content=e:this.view.skilllaunchnum?this.zjs.content=this.view.skilllaunchnum:this.zjs.content=""}}]),t}(h.Sprite);i["default"]=c},{"./max/display.js":17,"./max/utilities":20}],31:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./max/utilities"),h=e("./max/display.js"),c=function(e){function t(e){s(this,t);var i=n(this,Object.getPrototypeOf(t).call(this,o.assets["images/trans.png"]));return i.board=e,i.stepslimit=e.stepslimit,(0,h.text)("STEP","30px 微软雅黑","white",360,90,10),i.step=(0,h.text)(i.stepslimit,"30px 微软雅黑","white",450,90,10),i.step.align="center",i}return a(t,e),r(t,[{key:"myAction",value:function(){this.board.stepslimit!=this.stepslimit&&(this.stepslimit=this.board.stepslimit,this.step.content=this.stepslimit)}}]),t}(h.Sprite);i["default"]=c},{"./max/display.js":17,"./max/utilities":20}],32:[function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function n(){m.assets.load(["images/fk0.png","images/fk1.png","images/fk2.png","images/fk3.png","images/fk4.png","images/fk5.png","images/fk6.png","images/fk7.png","images/fk8.png","images/fk9.png","images/fk10.png","images/fk11.png","images/fk12.png","images/fk13.png","images/skill.png","images/fk_ice1.png","images/fk_ice2.png","images/fk_ice3.png","images/fk_door.png","images/fk_ice.png","images/fk_suolian.png","images/fk_nikuai.png","images/fk_cunmin.png","images/frame.png","images/grid.png","images/bggezi.png","images/xuanguan_bg1.png","images/xuanguan_bg1bu.png","images/bg1_1.png","images/bg1_2.png","images/bg1_3.png","images/bg1_4.png","images/main_touxiangdiban.png","images/main_jinengdiban.png","images/main_touxiangframe.png","images/main_jinengkuang.png","images/main_baoshihuang.png","images/main_dengji.png","images/main_renwu.png","images/main_wenhao.png","images/main_beibao.png","images/main_shangcheng.png","images/main_tujian.png","images/main_return.png","images/main_index.png","images/herotujian_di.png","images/hero_hecheng.png","images/hero_chouqu.png","images/hero_levelup.png","images/beibao_use.png","images/beibao_prop.png","images/beibao_compound.png","images/beibao_debris.png","images/beibao_equip.png","images/beibao_all.png","images/shop_sell.png","images/shop_raffle.png","images/shop_add.png","images/shop_minus.png","images/shop_numframe.png","images/shop_chouqu1.png","images/shop_chouqu10.png","images/shop_goumai.png","images/0.png","images/1.png","images/2.png","images/3.png","images/4.png","images/5.png","images/6.png","images/7.png","images/8.png","images/9.png","images/background.png","images/pause.png","images/trans.png","images/jixuyouxi.png","images/jieshuchuangguan.png","images/option.png","images/wenhao.png","images/guanqia.png","images/boss_live.png","images/boss_tongguan.png","images/fanye_prev.png","images/fanye_next.png","images/gameover.png","images/gameover_fanhui.png","images/gameover_zaici.png","images/gameclear.png","images/gameclear_xiaguan.png","images/star1.png","images/star2.png","images/guoguan1x.png","images/guoguan2x.png","images/guoguan3x.png"]).then(a)}function a(){r()}function r(){D=null,c(),new w.Index,u(o)}function o(e){if(Y.loop=requestAnimationFrame(o),Y.isrunning){X=e-I;for(var t=0;t<d.buttons.length;t++){
var i=d.buttons[t];i.update(A)}if((0,d.doMyAction)(d.stage.children),y.tweens.length>0)for(var t=y.tweens.length-1;t>=0;t--){var s=y.tweens[t];s&&s.update()}!T||T.gameclear||T.gameover||!H||H.gameclear||H.gameover||!T.gameOverJudge(X,H)||H.gameOver(),H&&X&&(H.movepasttime+=X),H&&H.movepasttime>1e4&&H.hintEliminate(T)}else x.pause.update(A,M),D&&D.update(A,M);(0,d.render)(M),I=e}function h(){Y.isrunning=!Y.isrunning,D||(D=(0,_.newPause)()),D.showOrHide()}function c(){null!=Y&&g(),d.stage.removeAll()}function l(e,t){if(c(),e>j.BOARDDATA.length)return console.log("关卡超过上限，出错！"+e),void r();var s=p(j.BOARDDATA[e-1]);t&&(s.hero=t),T=new b["default"](s),T.print(),i.view=H=new x.View(T),H.resetBlocks(),u(o)}function u(e){I=0,Y.isrunning=!0,Y.loop=requestAnimationFrame(e)}function g(){Y.isrunning=!1,Y.loop&&cancelAnimationFrame(Y.loop)}function f(){var e=navigator.userAgent.toLowerCase();return e.indexOf("android")>=0||e.indexOf("iphone")>=0||e.indexOf("ipad")>=0||e.indexOf("mobile")>=0||e.indexOf("phone")>=0}function p(e){var t=void 0;e instanceof Array?t=[]:e instanceof Object&&(t={});for(var i in e)e[i]instanceof Object?t[i]=p(e[i]):t[i]=e[i];return t}Object.defineProperty(i,"__esModule",{value:!0}),i.view=i.bossAssets=i.boardAssets=i.canvas=i.screen_width=i.screen_height=void 0,i["default"]=n,i.setup=a,i.gotoIndex=r,i.gamePause=h,i.gameSetup=l;var d=e("./max/display.js"),m=e("./max/utilities"),v=e("./max/interactive.js"),y=e("./max/tween.js"),k=e("./board.js"),b=s(k),x=e("./view.js"),w=e("./index.js"),_=e("./pause.js"),j=e("./information"),B=(e("./readyview.js"),i.screen_height=window.innerHeight),O=i.screen_width=.5625*B;f()&&(i.screen_width=O=window.innerWidth);var S=540,C=960,E=O/S,P=B/C,M=i.canvas=(0,d.makeCanvas)({width:O,height:B,rw:E,rh:P}),A=(0,v.makePointer)(M),T=void 0,Y={},X=void 0,I=void 0,D=void 0,H=(i.boardAssets=["images/fk0.png","images/fk1.png","images/fk2.png","images/fk3.png","images/fk4.png","images/fk5.png","images/fk6.png","images/fk7.png","images/fk8.png","images/fk9.png","images/fk10.png","images/fk11.png","images/fk12.png","images/fk13.png"],i.bossAssets=["images/boss_live.png","images/boss_live.png"],i.view=void 0)},{"./board.js":1,"./index.js":12,"./information":13,"./max/display.js":17,"./max/interactive.js":18,"./max/tween.js":19,"./max/utilities":20,"./pause.js":24,"./readyview.js":26,"./view.js":34}],33:[function(e,t,i){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0});var o=e("./max/utilities"),h=e("./max/display.js"),c=function(e){function t(e){s(this,t);var i=n(this,Object.getPrototypeOf(t).call(this,o.assets["images/trans.png"],620,35));return i.board=e,(0,h.text)("TIME","30px 微软雅黑","white",350,90,10),i.time=(0,h.text)(e.remainingtime,"30px 微软雅黑","white",440,90,10),i.time.align="center",i}return a(t,e),r(t,[{key:"myAction",value:function(){this.board.remainingtime>=0&&(this.time.content=parseInt(this.board.remainingtime/1e3))}}]),t}(h.Sprite);i["default"]=c},{"./max/display.js":17,"./max/utilities":20}],34:[function(e,t,i){"use strict";function s(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return e instanceof Array?e[e.length-1]:e}function r(e){return 0>e?-e:e}function o(e,t,i){if(t>i){var s=t;t=i,i=s}return e>=t&&i>=e}function h(e){if(!e)return 0;switch(e){case 1:case 4:case 7:case 10:return 1}}var c=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();Object.defineProperty(i,"__esModule",{value:!0}),i.View=i.pause=void 0;var l=e("./max/display.js"),u=e("./max/utilities"),g=e("./max/tween.js"),f=e("./t0.js"),p=e("./score.js"),d=s(p),m=e("./step.js"),v=s(m),y=e("./time.js"),k=s(y),b=e("./skill.js"),x=s(b),w=e("./mission.js"),_=s(w),j=e("./boss.js"),B=s(j),O=e("./floattext.js"),S=e("./board"),C=e("./gameover.js"),E=e("./gameclear.js"),P=i.pause=void 0;i.View=function(){function e(t){n(this,e),this.board=t,this.numBlockTypes=t.numBlockTypes,this._initBlocks(),this.cursor={x:0,y:0,selected:!1},this.animaSpeed=14,this.movepasttime=0,this.score=0,this.skillclick=0,this.skilllaunchnum=0,this.skillclickpoint=[],this.energy=t.energy,this.selectable=!0,this.gameover=!1,this.gameclear=!1,this.eliminate=t.eliminatedata.concat(),this.initStage()}return c(e,[{key:"_getBlock",value:function(e,t){return this.usedBlocks[e+","+t]}},{key:"_getPos",value:function(e,t){var i=void 0,s=void 0;if(e instanceof Array){i=[],s=[];for(var n=0;n<e.length;n++)i.push((0,l.calcPx)(35+67*e[n])),s.push((0,l.calcPx)(260+67*t[n],1))}else i=(0,l.calcPx)(35+67*e),s=(0,l.calcPx)(260+67*t,1);return{x:i,y:s}}},{key:"_initBlocks",value:function(){this.cachedBlocks=[],this.usedBlocks=[];for(var e=0;e<f.boardAssets.length;e++)this.cachedBlocks[e]=[]}},{key:"_setBlock",value:function(e,t,i){var s=this,n=void 0,a=void 0;t instanceof Array&&(t=t.pop(),i=i.pop()),n=35+67*t,a=260+67*i,e.setPosition((0,l.calcPx)(n),(0,l.calcPx)(a,1)),e.ix=t,e.iy=i,l.stage.addChild(e),e.type>=0&&!e.interactive&&!function(){e.interactive=!0;var t=s;e.press=function(e){t.selectBlockEffect(t.selectBlock(e.ix,e.iy),e)},e.moveIn=function(e){t.selectBlock(e.ix,e.iy),t.selectBlockEffect(!1)},e.release=function(e){if(9==t.skillclick&&t.skillclickpoint.length>1){t.cursor.selected=!1,t.selectable=!1,t.selectBlockEffect(!1);var i=t.calcSorcererSegmentNum();t.skilllaunchnum=t.skillclick=0,t.skillclickpoint=[],t.board.skillTrigger(9,i,t.boardEventsHandler.bind(t))}else 11==t.skillclick&&t.skillclickpoint.length>0&&(t.cursor.selected=!1,t.selectable=!1,t.selectBlockEffect(!1),t.skilllaunchnum--,t.skilllaunchnum<1&&(t.skillclick=0),t.board.skillTrigger(11,t.skillclickpoint.concat(),t.boardEventsHandler.bind(t)),t.skillclickpoint=[])}}(),this.usedBlocks[t+","+i]=e}},{key:"_useBlock",value:function(e){var t=void 0;if(0>e)t=new l.Sprite(u.assets["images/trans.png"]),t.layer=10,t.type=e;else{if(this.cachedBlocks[e].length<1){var i=void 0;i=u.assets[f.boardAssets[e]],t=new l.Sprite(i),t.layer=10,t.type=e,this.cachedBlocks[e].push(t)}t=this.cachedBlocks[e].pop()}return t.alpha=1,t.width=(0,l.calcPx)(60),t.height=(0,l.calcPx)(62,1),t}},{key:"_unuseBlock",value:function(e){e&&(e.parent&&(console.log("remove "+e.ix+", "+e.iy),l.stage.removeChild(e)),e.type>=0&&this.cachedBlocks[e.type].push(e),this.usedBlocks[e.ix+","+e.iy]=null,e.interactive=!1)}},{key:"boardEventsHandler",value:function(e){var t=this;if(e.length<=0)return this.board.swaping||this.board.skilltriggering?void 0:this.selectable=!0;var i=e.shift(),s=function(){t.boardEventsHandler(e)};switch(i.type){case"swap":this.swapBlocks(i.data,s);break;case"remove":this.removeBlocks(i.data,s);break;case"move":this.moveBlocks(i.data,s);break;case"refill":this.refill(i.data,s);break;case"score":this.scoreChange(i.data,s);break;case"change":this.changeStatus(i.data,s);break;case"bossdamage":this.bossDamage(i.data,s);break;case"gameover":this.gameOver();break;case"clear":this.gameClear();break;case"goldbeanremove":this.removeGoldBean(i.data,s);break;case"over":this.turnOver(s);break;case"updateskillnum":this.skillshow.hideTishi(),this.skillshow.updateNum(i.data),s&&s();break;default:s()}}},{key:"bossDamage",value:function(e,t){for(var i=0;i<e.length&&!(this.bosshp<=0);i++)this.bosshp-=e[i],(0,O.newFloatText)(e[i],this.boss.x,this.boss.y,"red");this.bosshp<0&&(this.bosshp=0),t&&t()}},{key:"calcSorcererSegmentNum",value:function(){if(9==this.skillclick){var e=this.skillclickpoint;if(!(e.length<2)){for(var t=[],i=e[0].x,s=e[0].y,n=void 0,a=void 0,r=-1,o=-1,h=void 0,c=void 0,l=1;l<e.length;l++){if(n=e[l].x,a=e[l].y,i==n?r=n:s==a&&(o=a),r>=0||o>=0){var u=t.length;if(u?(h=t[u-1].x,c=t[u-1].y,(r!=h||o!=c)&&t.push({x:r,y:o})):t.push({x:r,y:o}),t.length==this.skilllaunchnum)return t;r=o=-1}i=n,s=a}return t}}}},{key:"changeStatus",value:function(e,t){for(var i=0;i<e.length;i++){var s=e[i].x,n=e[i].y,a=e[i].data,r=e[i].type,o=e[i].edata;if("bl"==r){var h=this._getBlock(s,n);this._unuseBlock(h),h=this._useBlock(a),this._setBlock(h,s,n)}else if("bd"==r){var c=this.blockbg[s][n];switch(a){case 1:c.createFromImage(u.assets["images/trans.png"]),o&&this.eliminate[o]++;break;case 2:c.createFromImage(u.assets["images/fk_ice1.png"])}c.width=c.height=66}else if("sf"==r){var l=this.barrier[s][n];switch(a){case 1:l.createFromImage(u.assets["images/trans.png"]),o&&this.eliminate[o]++;break;case 3:l.createFromImage(u.assets["images/fk_nikuai.png"])}l.width=l.height=66}}t&&t()}},{key:"clearBlocks",value:function(){for(var e=arguments.length<=0||void 0===arguments[0]?this.board:arguments[0],t=0;t<e.cols;t++)for(var i=0;i<e.rows;i++){var s=this._getBlock(t,i);this._unuseBlock(s)}}},{key:"gameClear",value:function(){this.selectable=!1,this.gameclear=!0,l.stage.add(new E.Gameclear(this.board))}},{key:"gameOver",value:function(){return this.selectable=!1,null==this.board.mission?this.gameClear():(this.gameover=!0,void l.stage.add(new C.Gameover(this.board)))}},{key:"hintEliminate",value:function(e){if(this.movepasttime=0,!this.gameclear&&!this.gameover){var t=e._hasMoves();t.p2}}},{key:"initStage",value:function(){(0,l.spritE)(u.assets["images/bg1_1.png"],270,480,540,960),(0,l.spritE)(u.assets["images/bg1_2.png"],270,480,540,960,1),(0,l.spritE)(u.assets["images/bg1_3.png"],270,480,540,960,2),(0,l.spritE)(u.assets["images/bg1_4.png"],270,480,540,960,3),this.frame=(0,l.spritE)(u.assets["images/frame.png"],-99,0,67,67,15),l.stage.addChild(this.frame),i.pause=P=(0,l.newMyButton)(u.assets["images/pause.png"],500,40,60,60,5),P.release=f.gamePause,l.stage.addChild(new d["default"](this)),this.board.stepslimit&&l.stage.addChild(new v["default"](this.board)),this.board.time&&l.stage.addChild(new k["default"](this.board)),this.mission=new _["default"](this),l.stage.addChild(this.mission),this.skillshow=new x["default"](this),l.stage.addChild(this.skillshow),this.board.boss&&(this.boss=new B["default"](this),l.stage.add(this.boss),this.bosshp=this.board.boss.hp)}},{key:"moveBlocks",value:function(e,t){var i=this,s=e.length;!s&&t&&t();for(var n=0,a=function(s){var a=e[s],r=i._getBlock(a.fromX,a.fromY),o=i._getPos(a.fromX,a.fromY),h=i._getPos(a.toX,a.toY);i.missionClearJudge(a),r||(r=i._useBlock(a.type),r.setPosition(o.x,o.y),l.stage.addChild(r)),n++,(0,g.slidePath)(r,h.x,h.y,i.animaSpeed).onComplete=function(){i._setBlock(r,a.toX,a.toY),0==--n&&(i.movepasttime=0,i.board.print(),t&&t())}},r=0;r<e.length;r++)a(r)}},{key:"missionClearJudge",value:function(e){var t=e.toX,i=e.toY,s=e.fromX,n=e.fromY,r=this.board.getBlock(a(t),a(i)),h=this.board.mission;if(this.board.isHero(r)&&"escape"==h.type&&!this.missionclear){var c=h.data,l=c.x,u=c.y;if(t instanceof Array)for(var g=void 0,f=void 0,p=0;p<t.length;p++){if(g=t[p],f=i[p],s==g){if(l==s&&o(u,n,f))return this.missionclear=!0}else if(o(l,s,g)&&o(u,n,f))for(var d=s,m=n+1;f>=m;m++)if(g>s?d++:d--,l==d&&u==m)return this.missionclear=!0;s=g,n=f}else t==l&&i==u&&(this.missionclear=!0)}}},{key:"refill",value:function(e,t){this.resetBlocks(),console.log("reset blocks--------------------------------------------------***"),t&&t()}},{key:"removeBlocks",value:function(e,t){var i=this;!e.length&&t&&t();for(var s=0,n=function(n){var a=e[n],r=a.type;r<i.numBlockTypes?(i.eliminate[r]++,r==i.board.getColor(i.board.hero.id)&&i.energy<i.board.hero.energy&&i.energy++):7==r&&i.eliminate[7]++;var o=i._getBlock(a.x,a.y);s++;var h=(0,g.fadeOut)(o,i.animaSpeed);h.onComplete=function(){i._unuseBlock(o),0==--s&&t&&t()}},a=0;a<e.length;a++)n(a)}},{key:"removeGoldBean",value:function(e,t){this.removeBlocks(e,t)}},{key:"resetBlocks",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.board:arguments[0];this.clearBlocks(e),this.blockbg=[],this.barrier=[];for(var t=0;t<e.cols;t++){this.blockbg[t]=[],this.barrier[t]=[];for(var i=0;i<e.rows;i++){var s=this._useBlock(e.getBlock(t,i));this._setBlock(s,t,i),s.alpha=0,(0,g.fadeIn)(s);var n=!0,a=void 0,r=void 0,o=this._getPos(t,i),h=void 0,c=e.getBoardData(t,i);switch(o.x=(0,l.calcYuxiangPx)(o.x),o.y=(0,l.calcYuxiangPx)(o.y,1),1>c&&(n=!1),r=u.assets["images/trans.png"],c){case 2:r=u.assets["images/fk_ice1.png"];break;case 3:r=u.assets["images/fk_ice2.png"];break;case 4:r=u.assets["images/fk_door.png"],n=!1;break;case 5:n=!1}switch(a=(0,l.spritE)(r,o.x,o.y,66,66,9),this.blockbg[t][i]=a,r=u.assets["images/trans.png"],e.getSurface(t,i)){case 2:r=u.assets["images/fk_ice3.png"];break;case 3:r=u.assets["images/fk_nikuai.png"];break;case 4:r=u.assets["images/fk_suolian.png"];break;case 5:r=u.assets["images/fk_cunmin.png"]}h=(0,l.spritE)(r,o.x,o.y,66,66,11),this.barrier[t][i]=h,n&&(0,l.spritE)(u.assets["images/grid.png"],o.x,o.y,66,66,8)}}}},{key:"scoreChange",value:function(e,t){for(var i=0;i<e.length;i++){var s=e[i].score;this.turnscore+=s,this.score+=s;var n="gold";switch(e[i].type){case 0:n="silver";break;case 1:n="green";break;case 2:n="purple";break;case 3:n="black";break;case 4:n="yellow"}(0,O.newFloatText)(s,35+67*e[i].x,260+67*e[i].y,n)}t&&t()}},{key:"selectBlock",value:function(e,t){var i=arguments.length<=2||void 0===arguments[2]?this.board:arguments[2];if(this.selectable){if(0==arguments.length)return this.selectBlock(this.cursor.x,this.cursor.y);if(this.turnscore=0,this.cursor.selected){var s=r(e-this.cursor.x),n=r(t-this.cursor.y),a=s+n;if(3==this.skillclick||5==this.skillclick){var o=this.skillclickpoint[0];if(this.skillclickpoint=[],this.cursor.selected=!1,o.x==e&&o.y==t)return void(this.skillclick=0);if(3==this.skillclick){var h=this.board.getBlock(o.x,o.y),c=this.board.getBlock(e,t);if((this.board.isHero(h)||this.board.isHero(c))&&!(0,S.isAdjacent)(o.x,o.y,e,t))return alert("英雄只能移动一格"),void(this.skillclick=0)}return this.selectable=!1,this.selectBlockEffect(!1),i.skillTrigger(this.skillclick,{p:o,p2:{x:e,y:t}},this.boardEventsHandler.bind(this)),this.skillclick=0,this.setCursor(e,t,!1)}return 9==this.skillclick||11==this.skillclick?this.setCursor(e,t,!0):1==a?(this.selectable=!1,this.skillclickpoint=[],i.swap(this.cursor.x,this.cursor.y,e,t,this.boardEventsHandler.bind(this)),this.setCursor(e,t,!1)):this.setCursor(e,t,!0)}return this.setCursor(e,t,!0)}}},{key:"selectBlockEffect",value:function(e,t){if(e){var i=this._getPos(t.ix,t.iy);this.frame.x=i.x,this.frame.y=i.y}else this.frame.x=-100}},{key:"setCursor",value:function(e,t){var i=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];if(console.log("["+e+","+t+"] "+this._getBlock(e,t).type+" selected: "+i),arguments.length>0){if(Object.assign(this.cursor,{x:e,y:t,selected:i}),i){if(h(this.skillclick))return this.cursor.selected=!1,this.selectable=!1,this.selectBlockEffect(!1),this.skilllaunchnum&&this.skilllaunchnum--,this.board.skillTrigger(this.skillclick,{x:e,y:t,view:this},this.boardEventsHandler.bind(this)),void(this.skilllaunchnum<1&&(this.skillclick=0));var s=this.skillclickpoint.length;if(s){var n=this.skillclickpoint[s-1];n.x==e&&n.y==t||!(0,S.isAdjacent)(n.x,n.y,e,t)||this.skillclickpoint.push({x:e,y:t})}else this.skillclickpoint.push({x:e,y:t});if(console.log("x:"+e+",y:"+t+",length:"+s),9==this.skillclick){var a=this.calcSorcererSegmentNum();if(a&&a.length&&(this.skillshow.updateNum(this.skilllaunchnum-a.length),a.length==this.skilllaunchnum))return this.cursor.selected=!1,this.selectable=!1,this.selectBlockEffect(!1),this.skilllaunchnum=this.skillclick=0,this.skillclickpoint=[],void this.board.skillTrigger(9,a,this.boardEventsHandler.bind(this))}else if(11==this.skillclick&&s>1)return this.cursor.selected=!1,this.selectable=!1,this.selectBlockEffect(0),this.skilllaunchnum--,this.skilllaunchnum<1&&(this.skillclick=0),this.board.skillTrigger(11,this.skillclickpoint.concat(),this.boardEventsHandler.bind(this)),void(this.skillclickpoint=[])}}else this.cursor=null;return i}},{key:"swapBlocks",value:function(e,t){var i=this,s=this._getBlock(e.x1,e.y1),n=this._getBlock(e.x2,e.y2);this.missionClearJudge({fromX:e.x1,fromY:e.y1,toX:e.x2,toY:e.y2}),this.missionClearJudge({fromX:e.x2,fromY:e.y2,toX:e.x1,toY:e.y1});var a=this._getPos(e.x1,e.y1),r=this._getPos(e.x2,e.y2),o=2;(0,g.slide)(s,r.x,r.y,this.animaSpeed).onComplete=function(){s&&i._setBlock(s,e.x2,e.y2),0==--o&&t&&t()},(0,g.slide)(n,a.x,a.y,this.animaSpeed).onComplete=function(){n&&i._setBlock(n,e.x1,e.y1),0==--o&&t&&t()}}},{key:"turnOver",value:function(e){if(this.missionclear){var t=[];return this.board.hasClearMission(t,1),void this.boardEventsHandler(t)}e&&e()}}]),e}()},{"./board":1,"./boss.js":2,"./floattext.js":7,"./gameclear.js":8,"./gameover.js":9,"./max/display.js":17,"./max/tween.js":19,"./max/utilities":20,"./mission.js":21,"./score.js":27,"./skill.js":30,"./step.js":31,"./t0.js":32,"./time.js":33}]},{},[16]);